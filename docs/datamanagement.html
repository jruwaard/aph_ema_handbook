<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Ecological Momentary Assessment in Mental Health Research</title>
  <meta name="description" content="This is an Amsterdam Public Health (APH) Research Manual, written for researchers who are planning Ecological Momentary Assessment (EMA) studies.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Ecological Momentary Assessment in Mental Health Research" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover/smallcover.jpg" />
  <meta property="og:description" content="This is an Amsterdam Public Health (APH) Research Manual, written for researchers who are planning Ecological Momentary Assessment (EMA) studies." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Ecological Momentary Assessment in Mental Health Research" />
  
  <meta name="twitter:description" content="This is an Amsterdam Public Health (APH) Research Manual, written for researchers who are planning Ecological Momentary Assessment (EMA) studies." />
  <meta name="twitter:image" content="images/cover/smallcover.jpg" />

<meta name="author" content="Jeroen Ruwaard">
<meta name="author" content="Lisa Kooistra">
<meta name="author" content="Melissa Thong">


<meta name="date" content="2018-11-17">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="methods.html">
<link rel="next" href="mood.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
td.sourceCode { padding-left: 5px; }
code > span.kw { font-weight: bold; } /* Keyword */
code > span.dt { text-decoration: underline; } /* DataType */
code > span.co { font-style: italic; } /* Comment */
code > span.al { font-weight: bold; } /* Alert */
code > span.er { font-weight: bold; } /* Error */
code > span.wa { font-style: italic; } /* Warning */
code > span.cf { font-weight: bold; } /* ControlFlow */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.do { font-style: italic; } /* Documentation */
code > span.an { font-style: italic; } /* Annotation */
code > span.cv { font-style: italic; } /* CommentVar */
code > span.in { font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EMA research Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introducing EMA</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-ema"><i class="fa fa-check"></i><b>1.1</b> What is EMA?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#active-versus-passive-ema"><i class="fa fa-check"></i><b>1.1.1</b> Active versus Passive EMA</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#ema-sampling"><i class="fa fa-check"></i><b>1.1.2</b> EMA Sampling</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#why-ema"><i class="fa fa-check"></i><b>1.2</b> Why EMA?</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#to-minimize-recall-bias"><i class="fa fa-check"></i><b>1.2.1</b> To Minimize Recall Bias</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#to-maximize-ecological-validity"><i class="fa fa-check"></i><b>1.2.2</b> To Maximize Ecological Validity</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction.html"><a href="introduction.html#to-advance-ideographic-research"><i class="fa fa-check"></i><b>1.2.3</b> To Advance Ideographic Research</a></li>
<li class="chapter" data-level="1.2.4" data-path="introduction.html"><a href="introduction.html#to-understand-the-dynamic-interplay-between-symptoms"><i class="fa fa-check"></i><b>1.2.4</b> To Understand the Dynamic Interplay between Symptoms</a></li>
<li class="chapter" data-level="1.2.5" data-path="introduction.html"><a href="introduction.html#to-enable-emi"><i class="fa fa-check"></i><b>1.2.5</b> To Enable EMI</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#ema-research-findings-a-birds-eye-view"><i class="fa fa-check"></i><b>1.3</b> EMA Research Findings: A Birds-eye View</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#active-ema"><i class="fa fa-check"></i><b>1.3.1</b> Active EMA</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#passive-ema"><i class="fa fa-check"></i><b>1.3.2</b> Passive EMA</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#limitations"><i class="fa fa-check"></i><b>1.3.3</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-is-in-this-manual"><i class="fa fa-check"></i><b>1.4</b> What is in this Manual?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rstudio.html"><a href="rstudio.html"><i class="fa fa-check"></i><b>2</b> Introducing R &amp; RStudio</a><ul>
<li class="chapter" data-level="2.1" data-path="rstudio.html"><a href="rstudio.html#what-are-r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> What are R and RStudio?</a></li>
<li class="chapter" data-level="2.2" data-path="rstudio.html"><a href="rstudio.html#why-r"><i class="fa fa-check"></i><b>2.2</b> Why R?</a></li>
<li class="chapter" data-level="2.3" data-path="rstudio.html"><a href="rstudio.html#installing-r-rstudio"><i class="fa fa-check"></i><b>2.3</b> Installing R &amp; RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="rstudio.html"><a href="rstudio.html#interacting-with-r-through-the-rstudio-console"><i class="fa fa-check"></i><b>2.4</b> Interacting with R through the RStudio Console</a></li>
<li class="chapter" data-level="2.5" data-path="rstudio.html"><a href="rstudio.html#writing-r-scripts"><i class="fa fa-check"></i><b>2.5</b> Writing R-scripts</a></li>
<li class="chapter" data-level="2.6" data-path="rstudio.html"><a href="rstudio.html#importing-your-data"><i class="fa fa-check"></i><b>2.6</b> Importing Your Data</a><ul>
<li class="chapter" data-level="2.6.1" data-path="rstudio.html"><a href="rstudio.html#using-rstudio-menus-to-import-data"><i class="fa fa-check"></i><b>2.6.1</b> Using RStudio Menus to Import Data</a></li>
<li class="chapter" data-level="2.6.2" data-path="rstudio.html"><a href="rstudio.html#using-functions-to-import-data"><i class="fa fa-check"></i><b>2.6.2</b> Using Functions to Import Data</a></li>
<li class="chapter" data-level="2.6.3" data-path="rstudio.html"><a href="rstudio.html#accessing-your-data"><i class="fa fa-check"></i><b>2.6.3</b> Accessing your Data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="rstudio.html"><a href="rstudio.html#extending-r-with-packages"><i class="fa fa-check"></i><b>2.7</b> Extending R with Packages</a><ul>
<li class="chapter" data-level="2.7.1" data-path="rstudio.html"><a href="rstudio.html#installing-r-packages-from-cran"><i class="fa fa-check"></i><b>2.7.1</b> Installing R-packages from CRAN</a></li>
<li class="chapter" data-level="2.7.2" data-path="rstudio.html"><a href="rstudio.html#installing-r-packages-from-github"><i class="fa fa-check"></i><b>2.7.2</b> Installing R-packages from GitHub</a></li>
<li class="chapter" data-level="2.7.3" data-path="rstudio.html"><a href="rstudio.html#using-packages"><i class="fa fa-check"></i><b>2.7.3</b> Using Packages</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="rstudio.html"><a href="rstudio.html#getting-help"><i class="fa fa-check"></i><b>2.8</b> Getting Help</a><ul>
<li class="chapter" data-level="2.8.1" data-path="rstudio.html"><a href="rstudio.html#using-to-consult-the-documentation"><i class="fa fa-check"></i><b>2.8.1</b> Using ‘?’ to Consult the Documentation</a></li>
<li class="chapter" data-level="2.8.2" data-path="rstudio.html"><a href="rstudio.html#using-rstudios-global-documentation-index-search"><i class="fa fa-check"></i><b>2.8.2</b> Using RStudio’s Global Documentation Index Search</a></li>
<li class="chapter" data-level="2.8.3" data-path="rstudio.html"><a href="rstudio.html#learning-from-examples"><i class="fa fa-check"></i><b>2.8.3</b> Learning from Examples</a></li>
<li class="chapter" data-level="2.8.4" data-path="rstudio.html"><a href="rstudio.html#google"><i class="fa fa-check"></i><b>2.8.4</b> Google</a></li>
<li class="chapter" data-level="2.8.5" data-path="rstudio.html"><a href="rstudio.html#read-books"><i class="fa fa-check"></i><b>2.8.5</b> Read Books</a></li>
<li class="chapter" data-level="2.8.6" data-path="rstudio.html"><a href="rstudio.html#online-courses"><i class="fa fa-check"></i><b>2.8.6</b> Online Courses</a></li>
<li class="chapter" data-level="2.8.7" data-path="rstudio.html"><a href="rstudio.html#learn-r-in-r"><i class="fa fa-check"></i><b>2.8.7</b> Learn R, in R</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II EMA Methods</b></span></li>
<li class="chapter" data-level="3" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>3</b> Study Design</a><ul>
<li class="chapter" data-level="3.1" data-path="methods.html"><a href="methods.html#what-is-the-ema-research-question"><i class="fa fa-check"></i><b>3.1</b> What is the EMA Research Question?</a></li>
<li class="chapter" data-level="3.2" data-path="methods.html"><a href="methods.html#who-are-the-study-participants"><i class="fa fa-check"></i><b>3.2</b> Who are the Study Participants?</a></li>
<li class="chapter" data-level="3.3" data-path="methods.html"><a href="methods.html#what-are-the-qualities-of-the-ema-measures"><i class="fa fa-check"></i><b>3.3</b> What are the Qualities of the EMA Measures?</a></li>
<li class="chapter" data-level="3.4" data-path="methods.html"><a href="methods.html#what-is-the-sample-plan"><i class="fa fa-check"></i><b>3.4</b> What is the Sample Plan?</a></li>
<li class="chapter" data-level="3.5" data-path="methods.html"><a href="methods.html#what-is-the-optimal-sample-size"><i class="fa fa-check"></i><b>3.5</b> What is the Optimal Sample Size?</a></li>
<li class="chapter" data-level="3.6" data-path="methods.html"><a href="methods.html#what-are-the-ethical-aspects"><i class="fa fa-check"></i><b>3.6</b> What are the Ethical Aspects?</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="datamanagement.html"><a href="datamanagement.html"><i class="fa fa-check"></i><b>4</b> Data Management</a><ul>
<li class="chapter" data-level="4.1" data-path="datamanagement.html"><a href="datamanagement.html#using-rstudio-projects"><i class="fa fa-check"></i><b>4.1</b> Using RStudio-projects</a></li>
<li class="chapter" data-level="4.2" data-path="datamanagement.html"><a href="datamanagement.html#an-example-project-directory-structure"><i class="fa fa-check"></i><b>4.2</b> An Example Project Directory Structure</a></li>
<li class="chapter" data-level="4.3" data-path="datamanagement.html"><a href="datamanagement.html#data"><i class="fa fa-check"></i><b>4.3</b> Data</a></li>
<li class="chapter" data-level="4.4" data-path="datamanagement.html"><a href="datamanagement.html#import-scripts"><i class="fa fa-check"></i><b>4.4</b> Import Scripts</a></li>
<li class="chapter" data-level="4.5" data-path="datamanagement.html"><a href="datamanagement.html#cleaning"><i class="fa fa-check"></i><b>4.5</b> Cleaning</a></li>
<li class="chapter" data-level="4.6" data-path="datamanagement.html"><a href="datamanagement.html#pre-process"><i class="fa fa-check"></i><b>4.6</b> Pre-process</a></li>
<li class="chapter" data-level="4.7" data-path="datamanagement.html"><a href="datamanagement.html#combine"><i class="fa fa-check"></i><b>4.7</b> Combine</a></li>
<li class="chapter" data-level="4.8" data-path="datamanagement.html"><a href="datamanagement.html#reproducible-analyses"><i class="fa fa-check"></i><b>4.8</b> Reproducible Analyses</a></li>
<li class="chapter" data-level="4.9" data-path="datamanagement.html"><a href="datamanagement.html#documentation"><i class="fa fa-check"></i><b>4.9</b> Documentation</a><ul>
<li class="chapter" data-level="4.9.1" data-path="datamanagement.html"><a href="datamanagement.html#protocol"><i class="fa fa-check"></i><b>4.9.1</b> Protocol</a></li>
<li class="chapter" data-level="4.9.2" data-path="datamanagement.html"><a href="datamanagement.html#readme"><i class="fa fa-check"></i><b>4.9.2</b> README</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="datamanagement.html"><a href="datamanagement.html#discussion"><i class="fa fa-check"></i><b>4.10</b> Discussion</a></li>
</ul></li>
<li class="part"><span><b>III EMA Outcomes</b></span></li>
<li class="chapter" data-level="5" data-path="mood.html"><a href="mood.html"><i class="fa fa-check"></i><b>5</b> Mood</a><ul>
<li class="chapter" data-level="5.1" data-path="mood.html"><a href="mood.html#unidimensional-mood-assessment"><i class="fa fa-check"></i><b>5.1</b> Unidimensional Mood Assessment</a><ul>
<li class="chapter" data-level="5.1.1" data-path="mood.html"><a href="mood.html#bipolar-unidimensional-items"><i class="fa fa-check"></i><b>5.1.1</b> Bipolar Unidimensional Items</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="mood.html"><a href="mood.html#bag-of-items"><i class="fa fa-check"></i><b>5.2</b> Bag-of-Items</a></li>
<li class="chapter" data-level="5.3" data-path="mood.html"><a href="mood.html#multi-dimensional-mood-assessment"><i class="fa fa-check"></i><b>5.3</b> Multi-dimensional Mood Assessment</a><ul>
<li class="chapter" data-level="5.3.1" data-path="mood.html"><a href="mood.html#the-circumplex-model"><i class="fa fa-check"></i><b>5.3.1</b> The Circumplex Model</a></li>
<li class="chapter" data-level="5.3.2" data-path="mood.html"><a href="mood.html#negative-positive-affect"><i class="fa fa-check"></i><b>5.3.2</b> Negative &amp; Positive Affect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="activity.html"><a href="activity.html"><i class="fa fa-check"></i><b>6</b> Activity</a><ul>
<li class="chapter" data-level="6.1" data-path="activity.html"><a href="activity.html#actigraphy"><i class="fa fa-check"></i><b>6.1</b> Actigraphy</a><ul>
<li class="chapter" data-level="6.1.1" data-path="activity.html"><a href="activity.html#data-cleaning"><i class="fa fa-check"></i><b>6.1.1</b> Data cleaning</a></li>
<li class="chapter" data-level="6.1.2" data-path="activity.html"><a href="activity.html#feature-extraction"><i class="fa fa-check"></i><b>6.1.2</b> Feature Extraction</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="activity.html"><a href="activity.html#geotracking"><i class="fa fa-check"></i><b>6.2</b> Geotracking</a><ul>
<li class="chapter" data-level="6.2.1" data-path="activity.html"><a href="activity.html#the-geographic-coordinate-system"><i class="fa fa-check"></i><b>6.2.1</b> The Geographic Coordinate System</a></li>
<li class="chapter" data-level="6.2.2" data-path="activity.html"><a href="activity.html#the-global-positioning-system"><i class="fa fa-check"></i><b>6.2.2</b> The Global Positioning System</a></li>
<li class="chapter" data-level="6.2.3" data-path="activity.html"><a href="activity.html#gps-based-activity-measures"><i class="fa fa-check"></i><b>6.2.3</b> GPS-based Activity Measures</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Analytic Approaches</b></span></li>
<li class="chapter" data-level="7" data-path="features.html"><a href="features.html"><i class="fa fa-check"></i><b>7</b> Feature Extraction</a><ul>
<li class="chapter" data-level="7.1" data-path="features.html"><a href="features.html#simulated-ema-time-series-example"><i class="fa fa-check"></i><b>7.1</b> Simulated EMA Time-series Example</a></li>
<li class="chapter" data-level="7.2" data-path="features.html"><a href="features.html#central-tendency-and-variability"><i class="fa fa-check"></i><b>7.2</b> Central Tendency and Variability</a></li>
<li class="chapter" data-level="7.3" data-path="features.html"><a href="features.html#modelling-the-trend"><i class="fa fa-check"></i><b>7.3</b> Modelling the Trend</a></li>
<li class="chapter" data-level="7.4" data-path="features.html"><a href="features.html#missing-values"><i class="fa fa-check"></i><b>7.4</b> Missing Values</a></li>
<li class="chapter" data-level="7.5" data-path="features.html"><a href="features.html#auto-correlation"><i class="fa fa-check"></i><b>7.5</b> Auto-correlation</a><ul>
<li class="chapter" data-level="7.5.1" data-path="features.html"><a href="features.html#rolling-statistics"><i class="fa fa-check"></i><b>7.5.1</b> Rolling Statistics</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="features.html"><a href="features.html#periodicity"><i class="fa fa-check"></i><b>7.6</b> Periodicity</a></li>
<li class="chapter" data-level="7.7" data-path="features.html"><a href="features.html#discussion-1"><i class="fa fa-check"></i><b>7.7</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lmm.html"><a href="lmm.html"><i class="fa fa-check"></i><b>8</b> Mixed Modeling</a><ul>
<li class="chapter" data-level="8.1" data-path="lmm.html"><a href="lmm.html#the-mixed-model"><i class="fa fa-check"></i><b>8.1</b> The Mixed Model</a></li>
<li class="chapter" data-level="8.2" data-path="lmm.html"><a href="lmm.html#simulating-example-data"><i class="fa fa-check"></i><b>8.2</b> Simulating Example Data</a></li>
<li class="chapter" data-level="8.3" data-path="lmm.html"><a href="lmm.html#fitting-a-mixed-model-in-r"><i class="fa fa-check"></i><b>8.3</b> Fitting a Mixed Model in R</a></li>
<li class="chapter" data-level="8.4" data-path="lmm.html"><a href="lmm.html#adding-time-as-a-predictor"><i class="fa fa-check"></i><b>8.4</b> Adding Time as a Predictor</a></li>
<li class="chapter" data-level="8.5" data-path="lmm.html"><a href="lmm.html#adding-a-two-group-comparison"><i class="fa fa-check"></i><b>8.5</b> Adding a Two-Group Comparison</a></li>
<li class="chapter" data-level="8.6" data-path="lmm.html"><a href="lmm.html#next-steps"><i class="fa fa-check"></i><b>8.6</b> Next Steps</a></li>
</ul></li>
<li class="part"><span><b>V A Case Study</b></span></li>
<li class="chapter" data-level="9" data-path="csd.html"><a href="csd.html"><i class="fa fa-check"></i><b>9</b> Early Warning Signs of Depression</a><ul>
<li class="chapter" data-level="9.1" data-path="csd.html"><a href="csd.html#critical-slowing-down"><i class="fa fa-check"></i><b>9.1</b> Critical Slowing Down</a></li>
<li class="chapter" data-level="9.2" data-path="csd.html"><a href="csd.html#plotting-the-course-of-depression"><i class="fa fa-check"></i><b>9.2</b> Plotting the Course of Depression</a></li>
<li class="chapter" data-level="9.3" data-path="csd.html"><a href="csd.html#mental-state-ema-items"><i class="fa fa-check"></i><b>9.3</b> Mental state EMA Items</a></li>
<li class="chapter" data-level="9.4" data-path="csd.html"><a href="csd.html#running-the-dfa"><i class="fa fa-check"></i><b>9.4</b> Running the DFA</a></li>
<li class="chapter" data-level="9.5" data-path="csd.html"><a href="csd.html#results"><i class="fa fa-check"></i><b>9.5</b> Results</a></li>
<li class="chapter" data-level="9.6" data-path="csd.html"><a href="csd.html#discussion-2"><i class="fa fa-check"></i><b>9.6</b> Discussion</a></li>
</ul></li>
<li class="part"><span><b>VI EMA Catalogues</b></span></li>
<li class="chapter" data-level="10" data-path="catalogue.html"><a href="catalogue.html"><i class="fa fa-check"></i><b>10</b> EMA Research within the APH Mental Health Consortium</a><ul>
<li class="chapter" data-level="10.1" data-path="catalogue.html"><a href="catalogue.html#depression"><i class="fa fa-check"></i><b>10.1</b> Depression</a><ul>
<li class="chapter" data-level="10.1.1" data-path="catalogue.html"><a href="catalogue.html#bockting"><i class="fa fa-check"></i><b>10.1.1</b> Bockting</a></li>
<li class="chapter" data-level="10.1.2" data-path="catalogue.html"><a href="catalogue.html#penninx-and-lamers"><i class="fa fa-check"></i><b>10.1.2</b> Penninx and Lamers</a></li>
<li class="chapter" data-level="10.1.3" data-path="catalogue.html"><a href="catalogue.html#riper-and-smit"><i class="fa fa-check"></i><b>10.1.3</b> Riper and Smit</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="catalogue.html"><a href="catalogue.html#psychosomatic-symptoms"><i class="fa fa-check"></i><b>10.2</b> Psychosomatic Symptoms</a><ul>
<li class="chapter" data-level="10.2.1" data-path="catalogue.html"><a href="catalogue.html#knoop"><i class="fa fa-check"></i><b>10.2.1</b> Knoop</a></li>
<li class="chapter" data-level="10.2.2" data-path="catalogue.html"><a href="catalogue.html#sprangers"><i class="fa fa-check"></i><b>10.2.2</b> Sprangers</a></li>
<li class="chapter" data-level="10.2.3" data-path="catalogue.html"><a href="catalogue.html#snoek"><i class="fa fa-check"></i><b>10.2.3</b> Snoek</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="catalogue.html"><a href="catalogue.html#suicidal-ideation"><i class="fa fa-check"></i><b>10.3</b> Suicidal Ideation</a><ul>
<li class="chapter" data-level="10.3.1" data-path="catalogue.html"><a href="catalogue.html#van-ballegooijen"><i class="fa fa-check"></i><b>10.3.1</b> Van Ballegooijen</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="catalogue.html"><a href="catalogue.html#psychotic-symptoms"><i class="fa fa-check"></i><b>10.4</b> Psychotic symptoms</a><ul>
<li class="chapter" data-level="10.4.1" data-path="catalogue.html"><a href="catalogue.html#van-der-gaag"><i class="fa fa-check"></i><b>10.4.1</b> Van der Gaag</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="catalogue.html"><a href="catalogue.html#sleep"><i class="fa fa-check"></i><b>10.5</b> Sleep</a><ul>
<li class="chapter" data-level="10.5.1" data-path="catalogue.html"><a href="catalogue.html#van-someren"><i class="fa fa-check"></i><b>10.5.1</b> Van Someren</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="catalogue.html"><a href="catalogue.html#stress-emotion"><i class="fa fa-check"></i><b>10.6</b> Stress &amp; Emotion</a><ul>
<li class="chapter" data-level="10.6.1" data-path="catalogue.html"><a href="catalogue.html#de-geus"><i class="fa fa-check"></i><b>10.6.1</b> De Geus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html"><i class="fa fa-check"></i><b>11</b> EMA Instruments Catalogue</a><ul>
<li class="chapter" data-level="11.1" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#ema-platforms-apps"><i class="fa fa-check"></i><b>11.1</b> EMA Platforms &amp; Apps</a><ul>
<li class="chapter" data-level="11.1.1" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#ilumivu"><i class="fa fa-check"></i><b>11.1.1</b> Ilumivu</a></li>
<li class="chapter" data-level="11.1.2" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#moodbuster"><i class="fa fa-check"></i><b>11.1.2</b> Moodbuster</a></li>
<li class="chapter" data-level="11.1.3" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#movisens"><i class="fa fa-check"></i><b>11.1.3</b> Movisens</a></li>
<li class="chapter" data-level="11.1.4" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#psymate"><i class="fa fa-check"></i><b>11.1.4</b> PsyMate</a></li>
<li class="chapter" data-level="11.1.5" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#roqua"><i class="fa fa-check"></i><b>11.1.5</b> RoQua</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#wearables"><i class="fa fa-check"></i><b>11.2</b> Wearables</a><ul>
<li class="chapter" data-level="11.2.1" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#geneactiv"><i class="fa fa-check"></i><b>11.2.1</b> GENEActiv</a></li>
<li class="chapter" data-level="11.2.2" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#vu-ams"><i class="fa fa-check"></i><b>11.2.2</b> VU-AMS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="rcat.html"><a href="rcat.html"><i class="fa fa-check"></i><b>12</b> R Packages for EMA Research</a><ul>
<li class="chapter" data-level="12.1" data-path="rcat.html"><a href="rcat.html#accelerometry"><i class="fa fa-check"></i><b>12.1</b> Accelerometry</a><ul>
<li class="chapter" data-level="12.1.1" data-path="rcat.html"><a href="rcat.html#genearead"><i class="fa fa-check"></i><b>12.1.1</b> GENEAread</a></li>
<li class="chapter" data-level="12.1.2" data-path="rcat.html"><a href="rcat.html#physicalactivity"><i class="fa fa-check"></i><b>12.1.2</b> PhysicalActivity</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="rcat.html"><a href="rcat.html#autoregressive-modeling"><i class="fa fa-check"></i><b>12.2</b> Autoregressive modeling</a><ul>
<li class="chapter" data-level="12.2.1" data-path="rcat.html"><a href="rcat.html#autovarcore"><i class="fa fa-check"></i><b>12.2.1</b> autovarCore</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="rcat.html"><a href="rcat.html#data-management-visual-exploration"><i class="fa fa-check"></i><b>12.3</b> Data management &amp; Visual Exploration</a><ul>
<li class="chapter" data-level="12.3.1" data-path="rcat.html"><a href="rcat.html#dplyr"><i class="fa fa-check"></i><b>12.3.1</b> dplyr</a></li>
<li class="chapter" data-level="12.3.2" data-path="rcat.html"><a href="rcat.html#ggplot2"><i class="fa fa-check"></i><b>12.3.2</b> ggplot2</a></li>
<li class="chapter" data-level="12.3.3" data-path="rcat.html"><a href="rcat.html#haven"><i class="fa fa-check"></i><b>12.3.3</b> haven</a></li>
<li class="chapter" data-level="12.3.4" data-path="rcat.html"><a href="rcat.html#lubridate"><i class="fa fa-check"></i><b>12.3.4</b> lubridate</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="rcat.html"><a href="rcat.html#mixed-effects-modeling"><i class="fa fa-check"></i><b>12.4</b> Mixed-effects Modeling</a><ul>
<li class="chapter" data-level="12.4.1" data-path="rcat.html"><a href="rcat.html#nlme"><i class="fa fa-check"></i><b>12.4.1</b> nlme</a></li>
<li class="chapter" data-level="12.4.2" data-path="rcat.html"><a href="rcat.html#lme4"><i class="fa fa-check"></i><b>12.4.2</b> lme4</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="rcat.html"><a href="rcat.html#simulation"><i class="fa fa-check"></i><b>12.5</b> Simulation</a><ul>
<li class="chapter" data-level="12.5.1" data-path="rcat.html"><a href="rcat.html#simr"><i class="fa fa-check"></i><b>12.5.1</b> simr</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="rcat.html"><a href="rcat.html#simstudy"><i class="fa fa-check"></i><b>12.6</b> simstudy</a></li>
<li class="chapter" data-level="12.7" data-path="rcat.html"><a href="rcat.html#symptom-network-analysis"><i class="fa fa-check"></i><b>12.7</b> Symptom Network Analysis</a><ul>
<li class="chapter" data-level="12.7.1" data-path="rcat.html"><a href="rcat.html#qgraph"><i class="fa fa-check"></i><b>12.7.1</b> qgraph</a></li>
<li class="chapter" data-level="12.7.2" data-path="rcat.html"><a href="rcat.html#bootnet"><i class="fa fa-check"></i><b>12.7.2</b> bootnet</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="rcat.html"><a href="rcat.html#timeseries-analysis"><i class="fa fa-check"></i><b>12.8</b> Timeseries analysis</a><ul>
<li class="chapter" data-level="12.8.1" data-path="rcat.html"><a href="rcat.html#lomb"><i class="fa fa-check"></i><b>12.8.1</b> lomb</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VII Closing Matters</b></span></li>
<li class="chapter" data-level="" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Ecological Momentary Assessment in Mental Health Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="datamanagement" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Data Management</h1>

<p>In a typical EMA study, lots of data are collected. Repeated self-reports, GPS-data, accelerometer data, background demographic data and traditional questionnaire data quickly add up to gigabytes of raw data. Without proper data management, the EMA researcher would drown in these data. Fortunately, R and RStudio are useful aids to prevent this from happening. R is very flexible in the management of multiple data files, and RStudio includes a handy feature, called “Projects”, with which data and analysis scripts can be stored in an orderly fashion.</p>
<div id="using-rstudio-projects" class="section level2">
<h2><span class="header-section-number">4.1</span> Using RStudio-projects</h2>

<p>RStudio projects can be opened by double-clicking existing projects, or by creating new projects from RStudio’s file menu. To create a new project, choose <code>File &gt; New Project...</code>. You will be asked to specify the project name and its disk location (as shown in <a href="datamanagement.html#fig:fig5a">4.1</a>, after which the project will open in a new window.</p>
<div class="figure" style="text-align: center"><span id="fig:fig5a"></span>
<img src="images/datamanagement/new_project.png" alt="creating a project in RStudio" width="70%" />
<p class="caption">
Figure 4.1: creating a project in RStudio
</p>
</div>
<p>One of the advantages of using RStudio Projects is that projects set the working directory to the project directory location. You can verify this by asking R to print the current working directory, by typing the <code>getwd()</code> function in the console, while the project is open.</p>
<p>This may look like a trivial feature. It is, however, a great advantage, because it allows for the use of relative paths, which is very convenient. For example, to open a data source in a script, you no longer have to specify its full path (e.g., ‘D:/work/projects/my_ema_project/data/raw/ema_data.csv’). With relative paths, you can simply type ‘data/raw/ema_data.csv’. This saves typing, but, more importantly, it allows you to freely move your projects to other locations, without breaking the proper functioning of your scripts.</p>
</div>
<div id="an-example-project-directory-structure" class="section level2">
<h2><span class="header-section-number">4.2</span> An Example Project Directory Structure</h2>

<p>RStudio imposes no limitations to the contents of project directories. You are free to organize the project in the way you want. In clinical research, however, you are advised to choose a structure that aids you best to implement the following research guidelines:</p>
<ul>
<li><p>You should adhere strictly to a clear and logical directory structure, to ensure that co-workers and external auditors can quickly grasp and replicate your work;</p></li>
<li><p>Raw data should be part of your project, so that results can be traced back to their source;</p></li>
<li><p>Cleaned data should be separated from raw data, and data cleaning procedures should be explicit and replicable;</p></li>
<li><p>Data and analyses should be clearly separated;</p></li>
<li><p>All analyses should be explicit and replicable;</p></li>
<li><p>Output of (published) analyses should be saved.</p></li>
</ul>
<p>A directory structure based on these guidelines is listed in Figure <a href="datamanagement.html#fig:dm-project-tree">4.2</a>. It shows the organization of a (hypothetical) project in which data were collected via:</p>
<ol style="list-style-type: decimal">
<li><p>an online survey system, to assess demographics and pre/post study depression severity (with the PHQ-9 questionnaire, <span class="citation">Kroenke et al. (<a href="#ref-Kroenke2009">2009</a>)</span>),</p></li>
<li><p>an active EMA smartphone app, to assess day-to-day changes in mood, and</p></li>
<li><p>an accelerometer to assess activity levels.</p></li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:dm-project-tree"></span>
<img src="images/datamanagement/project_tree.png" alt="Example project directory structure" width="65%" />
<p class="caption">
Figure 4.2: Example project directory structure
</p>
</div>
</div>
<div id="data" class="section level2">
<h2><span class="header-section-number">4.3</span> Data</h2>

<p>Full replicability implies that raw data can be traced back to the source. Wherever possible, this should translate to the availability of raw study data in your project.</p>
<p>In the example project, unprocessed data files exported from the three data collection systems (i.e., survey data, EMA data, and actigraphy data) are stored in the ’data/raw“-directory’, in separate sub-directories per data type.</p>
<p>In ‘data/raw/survey’, we find two files: 1) ‘sur_t0_2018_05_01.csv’, containing the results of demographic questionnaire and the PHQ-9 pre-test, and 2) and ‘sur_t1_2018_05_01.csv’, containing the results of the PHQ-9 post-test. In exports of such survey systems, data from all participants are typically stored in one file per assessment moment. Note how the export date is added to the files, to make sure that future updates are only used in the analysis when explicitly noted.</p>
<p>In ‘data/raw/ema’, we find one file: ‘ema_2018_05_01.csv’, containing the results of the EMA mood measurements of all participants, exported from the back-office of the EMA platform.</p>
<p>Finally, in ‘data/raw/actigraphy’, we see a series of ‘.bin’ files: binary data files that were exported from, e.g., GENEActiv smart watches, that were worn by the participants. Actigraphy data are high-volume data: these files are typically large (500MB is no exception). By using the ‘.bin’ format, in which data are compressed, disk space is saved (in uncompressed format, data in a single .bin file can amount up to 2 GB). Unlike the survey and EMA mood data, each data file in this directory contains data of one participant. In this case, there are even two files for one participant (‘APC009’), perhaps because this participant started the study with a faulty device, which was swapped during the study.</p>
<p>In ‘data/raw’, a final very important file is ‘key_file.csv’. This file is important because it ties all the data together. It contains the unique identifiers (IDs) that are assigned to the study participants in the various data collection systems. Ideally, of course, participants would be designated by a single ID in each data collection system. In practice, unfortunately, this is often not possible due to limitations of the systems used. As a result, researchers are forced to deal with the fact that participants are known under different IDs in each system. With a key-file, data can be tied together through scripts.</p>
<p>In the example key-file below, we find four columns. The first column defines the global study ID for each participant (i.e., the ID that the researcher intends to use as the “official” ID). The other three columns define how the participant is identified in each data collection system.</p>
<table>
<caption><span id="tab:tab5a">Table 4.1: </span> Example Study Key-file</caption>
<thead>
<tr class="header">
<th align="left">ID</th>
<th align="left">Survey_ID</th>
<th align="left">EMA_ID</th>
<th align="left">Actigraphy_ID</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">P001</td>
<td align="left">QM01221</td>
<td align="left">192.A102.83A</td>
<td align="left">APC009</td>
</tr>
<tr class="even">
<td align="left">P002</td>
<td align="left">QM01228</td>
<td align="left">192.B106.73X</td>
<td align="left">APC010</td>
</tr>
<tr class="odd">
<td align="left">P003</td>
<td align="left">QM01230</td>
<td align="left">192.B220.00N</td>
<td align="left">APC011</td>
</tr>
</tbody>
</table>
</div>
<div id="import-scripts" class="section level2">
<h2><span class="header-section-number">4.4</span> Import Scripts</h2>
</div>
<div id="cleaning" class="section level2">
<h2><span class="header-section-number">4.5</span> Cleaning</h2>
<p>In ‘scripts/import’, we find the scripts with which the raw data are imported and cleaned, to produce ready-to-analyze data that are stored in ‘data/cleaned’.</p>
<p>By making these scripts parts of your project, you ensure that you and others can always trace the decisions that were made to prepare the raw data for analysis. Raw data may be updated, for instance because more participants are recruited, or because new data exports are made from the data collection systems. You may also detect errors in the import routines during the analyses, or peer reviewers may request information that can only be found by going back to the raw data. In all these cases, the availability of ready-to-run raw data import routines is crucial.</p>
<p>The code snippet below illustrates the kind of data transformations that you can expect to find in an import script. With a few lines of code, raw baseline questionnaire data are imported into R, participant id’s that are specific to the data collection system are replaced by the proper global study id, variables of interest are selected, data ranges are checked (and corrected if needed), and data types are set (in accordance to the study code-book). Finally, the cleaned data set is saved to the ‘data/cleaned’ folder, ready for further processing in the final analyses.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ------------------------------------------------------------</span>
<span class="co"># Clean data </span>
<span class="co"># JR - 2018-10-16</span>
<span class="co"># ------------------------------------------------------------</span>

<span class="co"># import raw baseline survey data (csv file) -----------------</span>
t0 &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/raw/survey/sur_t0_2018_05_01.csv&quot;</span>)

<span class="co"># inject study ID, from study key file -----------------------</span>
keys &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/raw/keyfile.csv&quot;</span>)
t0 &lt;-<span class="st"> </span><span class="kw">merge</span>(t0, keys)

<span class="co"># only keep variables of interest ----------------------------</span>
<span class="co"># (gender, age, phq item scores)</span>
t0 &lt;-<span class="st"> </span>t0[<span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;gender&quot;</span>, <span class="st">&quot;age&quot;</span>, <span class="kw">paste0</span>(<span class="st">&quot;phq&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>)]

<span class="co"># turn gender into a proper factor ---------------------------</span>
t0<span class="op">$</span>gender &lt;-<span class="st"> </span><span class="kw">factor</span>(t0<span class="op">$</span>gender, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;M&quot;</span>, <span class="st">&quot;F&quot;</span>))

<span class="co"># replace out-of-range data with missing values (NA) ---------</span>
t0<span class="op">$</span>age[t0<span class="op">$</span>age <span class="op">&gt;</span><span class="st"> </span><span class="dv">100</span>] &lt;-<span class="st"> </span><span class="ot">NA</span>
t0<span class="op">$</span>age[t0<span class="op">$</span>age <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>] &lt;-<span class="st"> </span><span class="ot">NA</span>

<span class="co"># replace out-of-range phq item data with missing values -----</span>
t0[<span class="kw">paste0</span>(<span class="st">&quot;phq&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>)] &lt;-<span class="st"> </span><span class="kw">lapply</span>(
  t0[<span class="kw">paste0</span>(<span class="st">&quot;phq&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>)], 
  <span class="cf">function</span>(x) {
    x[x <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="ot">NA</span>
    x[x <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>] &lt;-<span class="st"> </span><span class="ot">NA</span>
  })

<span class="co"># save cleaned baseline data --------------------------------- </span>
<span class="kw">save</span>(t0, <span class="dt">file =</span> <span class="st">&quot;data/cleaned/t0.Rda&quot;</span>)</code></pre></div>
<p>The code snippet above illustrates the importance of code documentation. You may struggle to immediately understand some of the code segments. For instance, you might not be familiar with the <code>paste0</code> function that is used to create the names of the variables that contain the PHQ-9 item scores. Fortunately, however, the comment (the lines starting with <code>#</code>) make it clear that the function is used to select individual PHQ-9 items. Comment your code. You will do yourself and your colleagues a big favor by making it much easier to quickly grasp the meaning of your code.</p>
</div>
<div id="pre-process" class="section level2">
<h2><span class="header-section-number">4.6</span> Pre-process</h2>
<p>Once data are cleaned, you can enrich the data sets with variables that can be derived from the raw data, such as, e.g., survey scale and subscale scores, if needed), or actigraphy summary measures (see Chapter <a href="activity.html#activity">6</a>). The example below calculates the PHQ-9 sum scores from the item scores in the cleaned baseline data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ------------------------------------------------------------</span>
<span class="co"># Pre-process data </span>
<span class="co"># JR - 2018-10-16</span>
<span class="co"># ------------------------------------------------------------</span>

<span class="co"># import cleaned baseline survey data ------------------------</span>
<span class="kw">load</span>(<span class="st">&quot;data/cleaned/baseline.Rda&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;data/cleaned/posttest.Rda&quot;</span>)

<span class="co"># add PHQ-9 sum scores ---------------------------------------</span>
baseline<span class="op">$</span>phq9 &lt;-<span class="st"> </span><span class="kw">rowSums</span>(baseline[<span class="kw">paste0</span>(<span class="st">&quot;phq&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>)], 
                         <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
posttest<span class="op">$</span>phq9 &lt;-<span class="st"> </span><span class="kw">rowSums</span>(posttest[<span class="kw">paste0</span>(<span class="st">&quot;phq&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>)], 
                         <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)

<span class="co"># re-save baseline data --------------------------------------</span>
<span class="kw">save</span>(baseline, <span class="dt">file =</span> <span class="st">&quot;data/cleaned/baseline.Rda&quot;</span>)
<span class="kw">save</span>(baseline, <span class="dt">file =</span> <span class="st">&quot;data/cleaned/posttest.Rda&quot;</span>)</code></pre></div>
</div>
<div id="combine" class="section level2">
<h2><span class="header-section-number">4.7</span> Combine</h2>
<p>While working on your project, you will probably want to re-run the cleaning and pre-processing scripts a lot, for instance in response to additional data coming in, or to fix bugs in the import routines. For this, it can be helpful to create one file in which all import scripts are executed in proper sequence. For this, you can use R’s <code>source</code> command, with which scripts can be read and executed directly from disk:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ------------------------------------------------------------</span>
<span class="co"># Import (clean &amp; pre-process) all data files </span>
<span class="co"># JR - 2018-10-16</span>
<span class="co"># ------------------------------------------------------------</span>

<span class="co"># clean -------------------------------</span>
<span class="kw">source</span>(<span class="st">&quot;scripts/import/clean_surveys.R&quot;</span>) 
<span class="kw">source</span>(<span class="st">&quot;scripts/import/clean_ema.R&quot;</span>) 
<span class="kw">source</span>(<span class="st">&quot;scripts/import/clean_actigraphy.R&quot;</span>) 

<span class="co"># pre-process----------------------------</span>
<span class="kw">source</span>(<span class="st">&quot;scripts/import/calc_surveys.R&quot;</span>) 
<span class="kw">source</span>(<span class="st">&quot;scripts/import/calc_ema.R&quot;</span>)
<span class="kw">source</span>(<span class="st">&quot;scripts/import/calc_actigraphy.R&quot;</span>) </code></pre></div>
</div>
<div id="reproducible-analyses" class="section level2">
<h2><span class="header-section-number">4.8</span> Reproducible Analyses</h2>
<p>When raw data stored, imported and cleaned, final analyses can be run. By basing these analyses on the cleaned data in ‘data/cleaned’, you ensure that these analyses can be fully reproduced from the raw study data.</p>
<p>The code snippet below illustrates a typical analysis file: cleaned data are loaded into the R work environment, after which EMA scores of a single participant are selected, plotted and analyzed in a simple linear regression. Both the plot and the result of the regression are saved in the analysis directory. The plot is saved as a PDF-file (ready for submission to the journal), and the regression results are saved in a standard R data structure.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># -------------------------------------------------------------</span>
<span class="co"># N = 1 Analysis (P001)</span>
<span class="co"># note: part of manuscript!</span>
<span class="co"># JR - 2018-10-16</span>
<span class="co"># ------------------------------------------------------------</span>

<span class="co"># import cleaned EMA mood study data --------------------------</span>
<span class="kw">load</span>(<span class="st">&quot;data/cleaned/ema.Rda&quot;</span>)

<span class="co"># create and save Figure 1: EMA mood data, of participant P001 </span>
d &lt;-<span class="st"> </span><span class="kw">subset</span>(mood, ID <span class="op">==</span><span class="st"> &quot;P001&quot;</span>)
<span class="kw">pdf</span>(<span class="dt">file =</span> <span class="st">&quot;scripts/published/figure1.pdf&quot;</span>)
<span class="kw">plot</span>(mood <span class="op">~</span><span class="st"> </span>time, d)
<span class="kw">dev.off</span>()

<span class="co"># run a regression model on P001 mood data</span>
fm &lt;-<span class="st"> </span><span class="kw">lm</span>(mood <span class="op">~</span><span class="st"> </span>time, d)
<span class="kw">summary</span>(fm)

<span class="co"># save regression results </span>
<span class="kw">save</span>(fm, <span class="dt">file =</span> <span class="st">&quot;scripts/published/P001_regression.Rda&quot;</span>)</code></pre></div>
<p>R’s ability to save the results of analyses to disk is yet another example of how R promotes accountability in clinical research. Suppose you used the regression analysis of ‘P001’ in a manuscript that you submitted for publication. Reviewers ask you to send residual plots, to convince them that the residual errors are normally distributed. When the regression results are saved to disk, the following three lines are all you need to satisfy their request:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Revisiting regression results, for a visual regression residual check  </span>
<span class="kw">load</span>(<span class="st">&quot;scripts/published/P001_regression.Rda&quot;</span>)

<span class="kw">pdf</span>(<span class="dt">file =</span> <span class="st">&quot;scripts/publised/residual_plot.pdf&quot;</span>)
<span class="kw">plot</span>(fm)
<span class="kw">dev.off</span>()</code></pre></div>
</div>
<div id="documentation" class="section level2">
<h2><span class="header-section-number">4.9</span> Documentation</h2>
<div id="protocol" class="section level3">
<h3><span class="header-section-number">4.9.1</span> Protocol</h3>
<p>In “docs/protocol”, we find the “protocol.docx” file, which should contain a detailed description of the study. This file provides information on the background of the study, the methods, analysis techniques, defines the codebook of the study, and should include full descriptions of all surveys, assessment protocols, etc.. If needed, you can use this folder to store additional background material, such as PDFs of published psychometric studies.</p>
</div>
<div id="readme" class="section level3">
<h3><span class="header-section-number">4.9.2</span> README</h3>
<p>Note, finally, the ‘README’ file in the root of the project directory. This file should contain a brief summary of the project, to quickly inform others (and your future self) of the context of the project and the contents of the project directory.</p>
<table style="width:78%;">
<colgroup>
<col width="23%" />
<col width="54%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Element</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Title</td>
<td align="left">Project title &amp; Acronym .</td>
</tr>
<tr class="even">
<td align="left">Description</td>
<td align="left">One-paragraph project description.</td>
</tr>
<tr class="odd">
<td align="left">Author</td>
<td align="left">Author name, e-mail affiliation.</td>
</tr>
<tr class="even">
<td align="left">Getting Started</td>
<td align="left">Instructions on how to get the project up and running on a local machine for development.</td>
</tr>
<tr class="odd">
<td align="left">Prerequisites</td>
<td align="left">A listing of software required (i.e. R packages), and instructions on how to install this software.</td>
</tr>
<tr class="even">
<td align="left">Contents</td>
<td align="left">A listing of project directories, with a brief description of their contents.</td>
</tr>
<tr class="odd">
<td align="left">Restrictions</td>
<td align="left">Notes about potential data access limitations.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="discussion" class="section level2">
<h2><span class="header-section-number">4.10</span> Discussion</h2>
<p>In this chapter, we aimed to show how adopting the RStudio Project can help you to implement key principles of EMA data management. To illustrate this, we discussed the project structure of a small-scale EMA study. No doubt, your project will differ from this example in many ways, forcing you to deviate from the example structure. The example may be too elaborate, for example, if your project only requires you to analyze a single data file. The structure is certainly too limited to support the requirements of a full PHD project (such as the one described, for example, in the APH quality handbook - see <a href="http://www.emgo.nl/kc/folders-and-file-names/" class="uri">http://www.emgo.nl/kc/folders-and-file-names/</a>). But as we mentioned earlier, RStudio Projects are flexible. It should be relatively straightforward to scale down or scale up the example that we discussed.</p>
<p>If you want to learn more about data management with R and RStudio, the book <em>“Reproducible Research with R and RStudio”</em> <span class="citation">(Gandrud, <a href="#ref-gandrud2015">2015</a>)</span> would be a good place to start. You may also be informed by the data management techniques that are described in the first two chapters of the book <em>“Using Rand RStudio for Data Management, Statistical Analysis, and Graphics”</em> <span class="citation">(Horton &amp; Kleinman, <a href="#ref-horton2015">2015</a>)</span>.</p>

</div>
</div>



<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Kroenke2009">
<p>Kroenke, K., Strine, T. W., Spitzer, R. L., Williams, J. B., Berry, J. T., &amp; Mokdad, A. H. (2009). The PHQ-8 as a measure of current depression in the general population. <em>Journal of Affective Disorders</em>, <em>114</em>(1-3), 163–173. <a href="https://doi.org/10.1016/j.jad.2008.06.026" class="uri">https://doi.org/10.1016/j.jad.2008.06.026</a></p>
</div>
<div id="ref-gandrud2015">
<p>Gandrud, C. (2015). <em>Reproducible research with R and RStudio</em>. Boca Raton: CRC Press / Taylor; Francis Group.</p>
</div>
<div id="ref-horton2015">
<p>Horton, N. J., &amp; Kleinman, K. (2015). <em>Using R and RStudio for data management, statistical analysis, and graphics</em>. Chapman; Hall/CRC.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mood.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["EMA_in_Mental_Health_Research.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
