<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Ecological Momentary Assessment in Mental Health Research</title>
  <meta name="description" content="This is an Amsterdam Public Health (APH) Research Manual, written for researchers who are planning Ecological Momentary Assessment (EMA) studies.">
  <meta name="generator" content="bookdown 0.7.13 and GitBook 2.6.7">

  <meta property="og:title" content="Ecological Momentary Assessment in Mental Health Research" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover.png" />
  <meta property="og:description" content="This is an Amsterdam Public Health (APH) Research Manual, written for researchers who are planning Ecological Momentary Assessment (EMA) studies." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Ecological Momentary Assessment in Mental Health Research" />
  
  <meta name="twitter:description" content="This is an Amsterdam Public Health (APH) Research Manual, written for researchers who are planning Ecological Momentary Assessment (EMA) studies." />
  <meta name="twitter:image" content="images/cover.png" />

<meta name="author" content="Jeroen Ruwaard">
<meta name="author" content="Lisa Kooistra">
<meta name="author" content="Melissa Thong">


<meta name="date" content="2018-11-12">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="features.html">
<link rel="next" href="csd.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
td.sourceCode { padding-left: 5px; }
code > span.kw { font-weight: bold; } /* Keyword */
code > span.dt { text-decoration: underline; } /* DataType */
code > span.co { font-style: italic; } /* Comment */
code > span.al { font-weight: bold; } /* Alert */
code > span.er { font-weight: bold; } /* Error */
code > span.wa { font-style: italic; } /* Warning */
code > span.cf { font-weight: bold; } /* ControlFlow */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.do { font-style: italic; } /* Documentation */
code > span.an { font-style: italic; } /* Annotation */
code > span.cv { font-style: italic; } /* CommentVar */
code > span.in { font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EMA research Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introducing EMA</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-ema"><i class="fa fa-check"></i><b>1.1</b> What is EMA?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#active-versus-passive-ema"><i class="fa fa-check"></i><b>1.1.1</b> Active versus Passive EMA</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#ema-sampling"><i class="fa fa-check"></i><b>1.1.2</b> EMA sampling</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#why-ema"><i class="fa fa-check"></i><b>1.2</b> Why EMA?</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#to-minimize-recall-bias-in-assessment"><i class="fa fa-check"></i><b>1.2.1</b> To minimize recall bias in assessment</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#to-increase-the-ecological-validity-of-research-findings"><i class="fa fa-check"></i><b>1.2.2</b> To increase the ecological validity of research findings</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction.html"><a href="introduction.html#to-advance-ideographic-research"><i class="fa fa-check"></i><b>1.2.3</b> To advance ideographic research</a></li>
<li class="chapter" data-level="1.2.4" data-path="introduction.html"><a href="introduction.html#to-enable-emi"><i class="fa fa-check"></i><b>1.2.4</b> To enable EMI</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#ema-research-findings-a-birds-eye-view"><i class="fa fa-check"></i><b>1.3</b> EMA research findings: A birds-eye view</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#active-ema"><i class="fa fa-check"></i><b>1.3.1</b> Active EMA</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#passive-ema"><i class="fa fa-check"></i><b>1.3.2</b> Passive EMA</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#limitations"><i class="fa fa-check"></i><b>1.3.3</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-is-in-this-manual"><i class="fa fa-check"></i><b>1.4</b> What is in this manual?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rstudio.html"><a href="rstudio.html"><i class="fa fa-check"></i><b>2</b> Introducing R &amp; RStudio</a><ul>
<li class="chapter" data-level="2.1" data-path="rstudio.html"><a href="rstudio.html#what-are-r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> What are R and RStudio?</a></li>
<li class="chapter" data-level="2.2" data-path="rstudio.html"><a href="rstudio.html#why-r"><i class="fa fa-check"></i><b>2.2</b> Why R?</a></li>
<li class="chapter" data-level="2.3" data-path="rstudio.html"><a href="rstudio.html#installing-r-rstudio"><i class="fa fa-check"></i><b>2.3</b> Installing R &amp; RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="rstudio.html"><a href="rstudio.html#interacting-with-r-through-the-rstudio-console"><i class="fa fa-check"></i><b>2.4</b> Interacting with R through the RStudio console</a></li>
<li class="chapter" data-level="2.5" data-path="rstudio.html"><a href="rstudio.html#writing-r-scripts"><i class="fa fa-check"></i><b>2.5</b> Writing R-scripts</a></li>
<li class="chapter" data-level="2.6" data-path="rstudio.html"><a href="rstudio.html#importing-your-data"><i class="fa fa-check"></i><b>2.6</b> Importing your data</a><ul>
<li class="chapter" data-level="2.6.1" data-path="rstudio.html"><a href="rstudio.html#using-rstudio-menus-to-import-data"><i class="fa fa-check"></i><b>2.6.1</b> Using RStudio menus to import data</a></li>
<li class="chapter" data-level="2.6.2" data-path="rstudio.html"><a href="rstudio.html#using-functions-to-import-data"><i class="fa fa-check"></i><b>2.6.2</b> Using functions to import data</a></li>
<li class="chapter" data-level="2.6.3" data-path="rstudio.html"><a href="rstudio.html#accessing-your-data"><i class="fa fa-check"></i><b>2.6.3</b> Accessing your data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="rstudio.html"><a href="rstudio.html#extending-r-with-packages"><i class="fa fa-check"></i><b>2.7</b> Extending R with Packages</a><ul>
<li class="chapter" data-level="2.7.1" data-path="rstudio.html"><a href="rstudio.html#installing-r-packages-from-cran"><i class="fa fa-check"></i><b>2.7.1</b> Installing R-packages from CRAN</a></li>
<li class="chapter" data-level="2.7.2" data-path="rstudio.html"><a href="rstudio.html#installing-r-packages-from-github"><i class="fa fa-check"></i><b>2.7.2</b> Installing R-packages from GitHub</a></li>
<li class="chapter" data-level="2.7.3" data-path="rstudio.html"><a href="rstudio.html#using-packages"><i class="fa fa-check"></i><b>2.7.3</b> Using packages</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="rstudio.html"><a href="rstudio.html#getting-help"><i class="fa fa-check"></i><b>2.8</b> Getting help</a><ul>
<li class="chapter" data-level="2.8.1" data-path="rstudio.html"><a href="rstudio.html#using-to-consult-the-documentation"><i class="fa fa-check"></i><b>2.8.1</b> Using ‘?’ to consult the documentation</a></li>
<li class="chapter" data-level="2.8.2" data-path="rstudio.html"><a href="rstudio.html#using-rstudios-global-documentation-index-search"><i class="fa fa-check"></i><b>2.8.2</b> Using RStudio’s global documentation index search</a></li>
<li class="chapter" data-level="2.8.3" data-path="rstudio.html"><a href="rstudio.html#learning-from-examples"><i class="fa fa-check"></i><b>2.8.3</b> Learning from examples</a></li>
<li class="chapter" data-level="2.8.4" data-path="rstudio.html"><a href="rstudio.html#google"><i class="fa fa-check"></i><b>2.8.4</b> Google</a></li>
<li class="chapter" data-level="2.8.5" data-path="rstudio.html"><a href="rstudio.html#read-books"><i class="fa fa-check"></i><b>2.8.5</b> Read books</a></li>
<li class="chapter" data-level="2.8.6" data-path="rstudio.html"><a href="rstudio.html#online-courses"><i class="fa fa-check"></i><b>2.8.6</b> Online Courses</a></li>
<li class="chapter" data-level="2.8.7" data-path="rstudio.html"><a href="rstudio.html#learn-r-in-r"><i class="fa fa-check"></i><b>2.8.7</b> Learn R, in R</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II EMA Methods</b></span></li>
<li class="chapter" data-level="3" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>3</b> Study Design</a><ul>
<li class="chapter" data-level="3.1" data-path="methods.html"><a href="methods.html#what-is-the-research-question"><i class="fa fa-check"></i><b>3.1</b> What is the research question?</a></li>
<li class="chapter" data-level="3.2" data-path="methods.html"><a href="methods.html#who-are-the-study-participants"><i class="fa fa-check"></i><b>3.2</b> Who are the study participants?</a></li>
<li class="chapter" data-level="3.3" data-path="methods.html"><a href="methods.html#what-are-the-qualities-of-the-ema-measures"><i class="fa fa-check"></i><b>3.3</b> What are the qualities of the EMA measures?</a></li>
<li class="chapter" data-level="3.4" data-path="methods.html"><a href="methods.html#what-is-the-sample-plan"><i class="fa fa-check"></i><b>3.4</b> What is the Sample Plan?</a></li>
<li class="chapter" data-level="3.5" data-path="methods.html"><a href="methods.html#what-is-the-optimal-sample-size"><i class="fa fa-check"></i><b>3.5</b> What is the Optimal Sample Size?</a></li>
<li class="chapter" data-level="3.6" data-path="methods.html"><a href="methods.html#what-are-the-ethical-aspects"><i class="fa fa-check"></i><b>3.6</b> What are the Ethical Aspects?</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="instruments.html"><a href="instruments.html"><i class="fa fa-check"></i><b>4</b> EMA instruments</a><ul>
<li class="chapter" data-level="4.1" data-path="instruments.html"><a href="instruments.html#general-considerations"><i class="fa fa-check"></i><b>4.1</b> General considerations</a><ul>
<li class="chapter" data-level="4.1.1" data-path="instruments.html"><a href="instruments.html#costs-new-development-vs-known-player"><i class="fa fa-check"></i><b>4.1.1</b> Costs new development vs known player</a></li>
<li class="chapter" data-level="4.1.2" data-path="instruments.html"><a href="instruments.html#low-tech-versus-high-tech"><i class="fa fa-check"></i><b>4.1.2</b> Low-tech versus high-tech</a></li>
<li class="chapter" data-level="4.1.3" data-path="instruments.html"><a href="instruments.html#access-to-a-back-office"><i class="fa fa-check"></i><b>4.1.3</b> Access to a back-office</a></li>
<li class="chapter" data-level="4.1.4" data-path="instruments.html"><a href="instruments.html#validation-and-reliability"><i class="fa fa-check"></i><b>4.1.4</b> Validation and reliability</a></li>
<li class="chapter" data-level="4.1.5" data-path="instruments.html"><a href="instruments.html#data-access"><i class="fa fa-check"></i><b>4.1.5</b> Data access</a></li>
<li class="chapter" data-level="4.1.6" data-path="instruments.html"><a href="instruments.html#demands-on-time"><i class="fa fa-check"></i><b>4.1.6</b> Demands on time</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="instruments.html"><a href="instruments.html#technical-considerations"><i class="fa fa-check"></i><b>4.2</b> Technical considerations</a><ul>
<li class="chapter" data-level="4.2.1" data-path="instruments.html"><a href="instruments.html#internet-access"><i class="fa fa-check"></i><b>4.2.1</b> Internet access</a></li>
<li class="chapter" data-level="4.2.2" data-path="instruments.html"><a href="instruments.html#device-limitations"><i class="fa fa-check"></i><b>4.2.2</b> Device limitations</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="instruments.html"><a href="instruments.html#participant-perspective"><i class="fa fa-check"></i><b>4.3</b> Participant perspective</a></li>
<li class="chapter" data-level="4.4" data-path="instruments.html"><a href="instruments.html#points-to-consider"><i class="fa fa-check"></i><b>4.4</b> Points to consider</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="datamanagement.html"><a href="datamanagement.html"><i class="fa fa-check"></i><b>5</b> Data management</a><ul>
<li class="chapter" data-level="5.1" data-path="datamanagement.html"><a href="datamanagement.html#using-rstudio-projects"><i class="fa fa-check"></i><b>5.1</b> Using RStudio-projects</a></li>
<li class="chapter" data-level="5.2" data-path="datamanagement.html"><a href="datamanagement.html#an-example-project-directory-structure"><i class="fa fa-check"></i><b>5.2</b> An Example Project Directory Structure</a></li>
<li class="chapter" data-level="5.3" data-path="datamanagement.html"><a href="datamanagement.html#data"><i class="fa fa-check"></i><b>5.3</b> Data</a></li>
<li class="chapter" data-level="5.4" data-path="datamanagement.html"><a href="datamanagement.html#import-scripts"><i class="fa fa-check"></i><b>5.4</b> Import scripts</a></li>
<li class="chapter" data-level="5.5" data-path="datamanagement.html"><a href="datamanagement.html#reproducible-analyses"><i class="fa fa-check"></i><b>5.5</b> Reproducible Analyses</a></li>
<li class="chapter" data-level="5.6" data-path="datamanagement.html"><a href="datamanagement.html#readme.txt"><i class="fa fa-check"></i><b>5.6</b> README.txt</a></li>
<li class="chapter" data-level="5.7" data-path="datamanagement.html"><a href="datamanagement.html#a-final-note"><i class="fa fa-check"></i><b>5.7</b> A final note</a></li>
</ul></li>
<li class="part"><span><b>III EMA Outcomes</b></span></li>
<li class="chapter" data-level="6" data-path="mood.html"><a href="mood.html"><i class="fa fa-check"></i><b>6</b> Mood</a><ul>
<li class="chapter" data-level="6.1" data-path="mood.html"><a href="mood.html#unidimensional-mood-assessment"><i class="fa fa-check"></i><b>6.1</b> Unidimensional mood assessment</a><ul>
<li class="chapter" data-level="6.1.1" data-path="mood.html"><a href="mood.html#bipolar-unidimensional-items"><i class="fa fa-check"></i><b>6.1.1</b> Bipolar unidimensional items</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="mood.html"><a href="mood.html#bag-of-items"><i class="fa fa-check"></i><b>6.2</b> Bag-of-Items</a></li>
<li class="chapter" data-level="6.3" data-path="mood.html"><a href="mood.html#multi-dimensional-mood-assessment"><i class="fa fa-check"></i><b>6.3</b> Multi-dimensional mood assessment</a><ul>
<li class="chapter" data-level="6.3.1" data-path="mood.html"><a href="mood.html#the-circumplex-model"><i class="fa fa-check"></i><b>6.3.1</b> The Circumplex Model</a></li>
<li class="chapter" data-level="6.3.2" data-path="mood.html"><a href="mood.html#negative-positive-affect"><i class="fa fa-check"></i><b>6.3.2</b> Negative &amp; Positive Affect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="activity.html"><a href="activity.html"><i class="fa fa-check"></i><b>7</b> Activity</a><ul>
<li class="chapter" data-level="7.1" data-path="activity.html"><a href="activity.html#actigraphy"><i class="fa fa-check"></i><b>7.1</b> Actigraphy</a><ul>
<li class="chapter" data-level="7.1.1" data-path="activity.html"><a href="activity.html#data-cleaning"><i class="fa fa-check"></i><b>7.1.1</b> Data cleaning</a></li>
<li class="chapter" data-level="7.1.2" data-path="activity.html"><a href="activity.html#feature-extraction"><i class="fa fa-check"></i><b>7.1.2</b> Feature extraction</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="activity.html"><a href="activity.html#geotracking"><i class="fa fa-check"></i><b>7.2</b> Geotracking</a><ul>
<li class="chapter" data-level="7.2.1" data-path="activity.html"><a href="activity.html#the-geographic-coordinate-system"><i class="fa fa-check"></i><b>7.2.1</b> The Geographic Coordinate System</a></li>
<li class="chapter" data-level="7.2.2" data-path="activity.html"><a href="activity.html#the-global-positioning-system"><i class="fa fa-check"></i><b>7.2.2</b> The Global Positioning System</a></li>
<li class="chapter" data-level="7.2.3" data-path="activity.html"><a href="activity.html#gps-based-activity-measures"><i class="fa fa-check"></i><b>7.2.3</b> GPS-based activity measures</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Analytic Approaches</b></span></li>
<li class="chapter" data-level="8" data-path="features.html"><a href="features.html"><i class="fa fa-check"></i><b>8</b> Feature Extraction</a><ul>
<li class="chapter" data-level="8.1" data-path="features.html"><a href="features.html#simulated-ema-time-series-example"><i class="fa fa-check"></i><b>8.1</b> Simulated EMA Time-series Example</a></li>
<li class="chapter" data-level="8.2" data-path="features.html"><a href="features.html#central-tendency-and-variability"><i class="fa fa-check"></i><b>8.2</b> Central Tendency and Variability</a></li>
<li class="chapter" data-level="8.3" data-path="features.html"><a href="features.html#modelling-the-trend"><i class="fa fa-check"></i><b>8.3</b> Modelling the Trend</a></li>
<li class="chapter" data-level="8.4" data-path="features.html"><a href="features.html#missing-values"><i class="fa fa-check"></i><b>8.4</b> Missing Values</a></li>
<li class="chapter" data-level="8.5" data-path="features.html"><a href="features.html#autocorrelation"><i class="fa fa-check"></i><b>8.5</b> Autocorrelation</a><ul>
<li class="chapter" data-level="8.5.1" data-path="features.html"><a href="features.html#rolling-statistics"><i class="fa fa-check"></i><b>8.5.1</b> Rolling statistics</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="features.html"><a href="features.html#periodicity"><i class="fa fa-check"></i><b>8.6</b> Periodicity</a></li>
<li class="chapter" data-level="8.7" data-path="features.html"><a href="features.html#discussion"><i class="fa fa-check"></i><b>8.7</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="lmm.html"><a href="lmm.html"><i class="fa fa-check"></i><b>9</b> Mixed Modeling</a><ul>
<li class="chapter" data-level="9.1" data-path="lmm.html"><a href="lmm.html#the-mixed-model"><i class="fa fa-check"></i><b>9.1</b> The Mixed Model</a></li>
<li class="chapter" data-level="9.2" data-path="lmm.html"><a href="lmm.html#simulating-example-data"><i class="fa fa-check"></i><b>9.2</b> Simulating Example Data</a></li>
<li class="chapter" data-level="9.3" data-path="lmm.html"><a href="lmm.html#fitting-a-mixed-model-in-r"><i class="fa fa-check"></i><b>9.3</b> Fitting a Mixed Model in R</a></li>
<li class="chapter" data-level="9.4" data-path="lmm.html"><a href="lmm.html#adding-time-as-a-predictor"><i class="fa fa-check"></i><b>9.4</b> Adding Time as a Predictor</a></li>
<li class="chapter" data-level="9.5" data-path="lmm.html"><a href="lmm.html#adding-a-two-group-comparison"><i class="fa fa-check"></i><b>9.5</b> Adding a Two-Group Comparison</a></li>
<li class="chapter" data-level="9.6" data-path="lmm.html"><a href="lmm.html#next-steps"><i class="fa fa-check"></i><b>9.6</b> Next Steps</a></li>
</ul></li>
<li class="part"><span><b>V A Case Study</b></span></li>
<li class="chapter" data-level="10" data-path="csd.html"><a href="csd.html"><i class="fa fa-check"></i><b>10</b> Early Warning Signs of Depression</a><ul>
<li class="chapter" data-level="10.1" data-path="csd.html"><a href="csd.html#critical-slowing-down"><i class="fa fa-check"></i><b>10.1</b> Critical Slowing Down</a></li>
<li class="chapter" data-level="10.2" data-path="csd.html"><a href="csd.html#plotting-the-course-of-depression"><i class="fa fa-check"></i><b>10.2</b> Plotting the course of depression</a></li>
<li class="chapter" data-level="10.3" data-path="csd.html"><a href="csd.html#mental-state-ema-items"><i class="fa fa-check"></i><b>10.3</b> Mental state EMA items</a></li>
<li class="chapter" data-level="10.4" data-path="csd.html"><a href="csd.html#running-the-dfa"><i class="fa fa-check"></i><b>10.4</b> Running the DFA</a></li>
<li class="chapter" data-level="10.5" data-path="csd.html"><a href="csd.html#results"><i class="fa fa-check"></i><b>10.5</b> Results</a></li>
<li class="chapter" data-level="10.6" data-path="csd.html"><a href="csd.html#discussion-1"><i class="fa fa-check"></i><b>10.6</b> Discussion</a></li>
</ul></li>
<li class="part"><span><b>VI EMA Catalogues</b></span></li>
<li class="chapter" data-level="11" data-path="catalogue.html"><a href="catalogue.html"><i class="fa fa-check"></i><b>11</b> EMA Research within the APH Mental Health Consortium</a><ul>
<li class="chapter" data-level="11.1" data-path="catalogue.html"><a href="catalogue.html#depression"><i class="fa fa-check"></i><b>11.1</b> Depression</a><ul>
<li class="chapter" data-level="11.1.1" data-path="catalogue.html"><a href="catalogue.html#bockting"><i class="fa fa-check"></i><b>11.1.1</b> Bockting</a></li>
<li class="chapter" data-level="11.1.2" data-path="catalogue.html"><a href="catalogue.html#penninx-and-lamers"><i class="fa fa-check"></i><b>11.1.2</b> Penninx and Lamers</a></li>
<li class="chapter" data-level="11.1.3" data-path="catalogue.html"><a href="catalogue.html#riper-and-smit"><i class="fa fa-check"></i><b>11.1.3</b> Riper and Smit</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="catalogue.html"><a href="catalogue.html#psychosomatic-symptoms"><i class="fa fa-check"></i><b>11.2</b> Psychosomatic symptoms</a><ul>
<li class="chapter" data-level="11.2.1" data-path="catalogue.html"><a href="catalogue.html#knoop"><i class="fa fa-check"></i><b>11.2.1</b> Knoop</a></li>
<li class="chapter" data-level="11.2.2" data-path="catalogue.html"><a href="catalogue.html#sprangers"><i class="fa fa-check"></i><b>11.2.2</b> Sprangers</a></li>
<li class="chapter" data-level="11.2.3" data-path="catalogue.html"><a href="catalogue.html#snoek"><i class="fa fa-check"></i><b>11.2.3</b> Snoek</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="catalogue.html"><a href="catalogue.html#suicidal-ideation"><i class="fa fa-check"></i><b>11.3</b> Suicidal Ideation</a><ul>
<li class="chapter" data-level="11.3.1" data-path="catalogue.html"><a href="catalogue.html#van-ballegooijen"><i class="fa fa-check"></i><b>11.3.1</b> Van Ballegooijen</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="catalogue.html"><a href="catalogue.html#psychotic-symptoms"><i class="fa fa-check"></i><b>11.4</b> Psychotic symptoms</a><ul>
<li class="chapter" data-level="11.4.1" data-path="catalogue.html"><a href="catalogue.html#van-der-gaag"><i class="fa fa-check"></i><b>11.4.1</b> Van der Gaag</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="catalogue.html"><a href="catalogue.html#sleep"><i class="fa fa-check"></i><b>11.5</b> Sleep</a><ul>
<li class="chapter" data-level="11.5.1" data-path="catalogue.html"><a href="catalogue.html#van-someren"><i class="fa fa-check"></i><b>11.5.1</b> Van Someren</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="catalogue.html"><a href="catalogue.html#ambulatory-assessment"><i class="fa fa-check"></i><b>11.6</b> Ambulatory Assessment</a><ul>
<li class="chapter" data-level="11.6.1" data-path="catalogue.html"><a href="catalogue.html#de-geus"><i class="fa fa-check"></i><b>11.6.1</b> De Geus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html"><i class="fa fa-check"></i><b>12</b> EMA Instruments Catalogue</a><ul>
<li class="chapter" data-level="12.1" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#geneactive"><i class="fa fa-check"></i><b>12.1</b> GENEActive</a></li>
<li class="chapter" data-level="12.2" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#ilumivu"><i class="fa fa-check"></i><b>12.2</b> Ilumivu</a></li>
<li class="chapter" data-level="12.3" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#moodbuster"><i class="fa fa-check"></i><b>12.3</b> Moodbuster</a></li>
<li class="chapter" data-level="12.4" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#movisens"><i class="fa fa-check"></i><b>12.4</b> Movisens</a></li>
<li class="chapter" data-level="12.5" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#psymate"><i class="fa fa-check"></i><b>12.5</b> PsyMate</a></li>
<li class="chapter" data-level="12.6" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#roqua"><i class="fa fa-check"></i><b>12.6</b> RoQua</a><ul>
<li class="chapter" data-level="12.6.1" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#vu-ams"><i class="fa fa-check"></i><b>12.6.1</b> VU-AMS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="rcat.html"><a href="rcat.html"><i class="fa fa-check"></i><b>13</b> R Packages for EMA Research</a><ul>
<li class="chapter" data-level="13.1" data-path="rcat.html"><a href="rcat.html#accelerometry"><i class="fa fa-check"></i><b>13.1</b> Accelerometry</a><ul>
<li class="chapter" data-level="13.1.1" data-path="rcat.html"><a href="rcat.html#package-genearead"><i class="fa fa-check"></i><b>13.1.1</b> Package GENEAread</a></li>
<li class="chapter" data-level="13.1.2" data-path="rcat.html"><a href="rcat.html#package-ggir"><i class="fa fa-check"></i><b>13.1.2</b> Package ‘GGIR’</a></li>
<li class="chapter" data-level="13.1.3" data-path="rcat.html"><a href="rcat.html#package-physicalactivity"><i class="fa fa-check"></i><b>13.1.3</b> Package ‘PhysicalActivity’</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="rcat.html"><a href="rcat.html#data-management-visual-exploration"><i class="fa fa-check"></i><b>13.2</b> Data management &amp; Visual Exploration</a><ul>
<li class="chapter" data-level="13.2.1" data-path="rcat.html"><a href="rcat.html#package-dplyr"><i class="fa fa-check"></i><b>13.2.1</b> Package <code>dplyr</code></a></li>
<li class="chapter" data-level="13.2.2" data-path="rcat.html"><a href="rcat.html#package-ggplot2"><i class="fa fa-check"></i><b>13.2.2</b> Package ‘ggplot2’</a></li>
<li class="chapter" data-level="13.2.3" data-path="rcat.html"><a href="rcat.html#package-haven"><i class="fa fa-check"></i><b>13.2.3</b> Package ‘haven’</a></li>
<li class="chapter" data-level="13.2.4" data-path="rcat.html"><a href="rcat.html#package-lubridate"><i class="fa fa-check"></i><b>13.2.4</b> Package ‘lubridate’</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="rcat.html"><a href="rcat.html#mixed-effects-modeling"><i class="fa fa-check"></i><b>13.3</b> Mixed-effects modeling</a><ul>
<li class="chapter" data-level="13.3.1" data-path="rcat.html"><a href="rcat.html#nlme"><i class="fa fa-check"></i><b>13.3.1</b> nlme</a></li>
<li class="chapter" data-level="13.3.2" data-path="rcat.html"><a href="rcat.html#lme4"><i class="fa fa-check"></i><b>13.3.2</b> lme4</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="rcat.html"><a href="rcat.html#power-analysis"><i class="fa fa-check"></i><b>13.4</b> Power analysis</a><ul>
<li class="chapter" data-level="13.4.1" data-path="rcat.html"><a href="rcat.html#package-simr"><i class="fa fa-check"></i><b>13.4.1</b> Package ‘simr’</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="rcat.html"><a href="rcat.html#symptom-network-analysis"><i class="fa fa-check"></i><b>13.5</b> Symptom Network Analysis</a><ul>
<li class="chapter" data-level="13.5.1" data-path="rcat.html"><a href="rcat.html#package-autovarcore"><i class="fa fa-check"></i><b>13.5.1</b> Package ’autovarCore`</a></li>
<li class="chapter" data-level="13.5.2" data-path="rcat.html"><a href="rcat.html#package-qgraph"><i class="fa fa-check"></i><b>13.5.2</b> Package ’qgraph`</a></li>
<li class="chapter" data-level="13.5.3" data-path="rcat.html"><a href="rcat.html#package-bootnet"><i class="fa fa-check"></i><b>13.5.3</b> Package ‘bootnet’</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="rcat.html"><a href="rcat.html#timeseries-analysis"><i class="fa fa-check"></i><b>13.6</b> Timeseries analysis</a><ul>
<li class="chapter" data-level="13.6.1" data-path="rcat.html"><a href="rcat.html#package-lomb"><i class="fa fa-check"></i><b>13.6.1</b> Package ‘lomb’</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VII Closing Matters</b></span></li>
<li class="chapter" data-level="" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Ecological Momentary Assessment in Mental Health Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lmm" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Mixed Modeling</h1>

<p>EMA data are time-series that are characterized by complex correlational structures, irregular sampling intervals, missing data, and substantive individual differences. Mixed models are well-suited to deal with these data. This chapter provides a brief introduction to conducting mixed model analysis of EMA data in R.</p>
<div id="the-mixed-model" class="section level2">
<h2><span class="header-section-number">9.1</span> The Mixed Model</h2>

<p>Mixed modeling can be understood as a regression technique in which separate regression functions are estimated for each cluster in the data set. In EMA data, these clusters are defined by the participants. Data from the same participant are expected to be correlated, and one way to honor this correlation is to conceptualize a separate regression for each participant. This idea, in the simplest regression model, can be expressed as:</p>
<span class="math display">\[\begin{equation} 
  Y_{ij} = intercept_{i} + \epsilon_{ij} 
\end{equation}\]</span>
<p>This models the expected value of the j-th measurement of participant i as the mean of all measurements of participant i, plus error. It defines a set of regression functions - one for each participant. The regression functions are, however, not independent. Mixed models divide the intercepts of the individual participant regression functions into two components: 1) the intercept of the group (<em>intercept<sub>g</sub></em>; the mean intercept of all regression functions), and 2) a participant-specific component <em>intercept<sub>p</sub></em> (i.e., the difference between the intercept of the participant and the mean intercept), i.e.:</p>
<span class="math display">\[\begin{equation} 
  intercept_{i} = intercept_{g} + intercept_{p} 
\end{equation}\]</span>
<p>The group intercept is called the ‘fixed’ effect. If we would gather more data from new participants, we would expect to find approximately the same group intercept. The participant-specific component of the intercept is known as the ‘random’ effect. If we sample new data, we would expect a similar <em>variance</em> of the participant-specific intercept components around the group intercept. This “mixing” of fixed and random effects is what gives mixed modeling its name.</p>
</div>
<div id="simulating-example-data" class="section level2">
<h2><span class="header-section-number">9.2</span> Simulating Example Data</h2>

<p>To understand analysis techniques, it often helps to apply the technique to simulated data, in which parameters of interest are known. Here, we will use the <code>sim_ema</code> function from package <code>emaph</code>, to simulate EMA mood assessments of 100 participants, who rate their mood, three times per day, for one week. As you can learn from the documentation of <code>sim_ema</code> (see <code>?sim\_ema</code>), the function expects at least two arguments: the definition of a sample plan (see <code>?sample\_plan</code>), and a specification of the data-generating model, in the form of a list defining fixed effects, the random effects, and residual variance (i.e, the error).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Simulating ema data.</span>
<span class="kw">library</span>(emaph)
plan &lt;-<span class="st"> </span><span class="kw">sample_plan</span>(<span class="dt">n_participants =</span> <span class="dv">100</span>, 
                    <span class="dt">n_days =</span> <span class="dv">7</span>,
                    <span class="dt">times =</span> <span class="kw">c</span>(<span class="st">&quot;10:00-11:00&quot;</span>, 
                              <span class="st">&quot;13:00-14:00&quot;</span>, 
                              <span class="st">&quot;16:00-18:00&quot;</span>))

d1 &lt;-<span class="st"> </span><span class="kw">sim_ema</span>(plan, 
              <span class="dt">mm_par =</span> <span class="kw">list</span>(<span class="dt">fixed  =</span> <span class="kw">c</span>(<span class="dt">intercept =</span> <span class="dv">5</span>),
                            <span class="dt">random =</span> <span class="kw">c</span>(<span class="dt">intercept =</span> <span class="dv">1</span>),
                            <span class="dt">error =</span> .<span class="dv">5</span>),
              <span class="dt">lim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</code></pre></div>
<p>From the code, you learn that we set the mean mood (intercept<sub>g</sub>) to 5, the variance around this mean - var(intercept<sub>i</sub>) - to 1, and the variance around these means within participants - the error - to .5. Figure <a href="lmm.html#fig:fig9a">9.1</a> shows EMA mood ratings of the first 6 participants in the simulated data set, which we can use to check the simulation. As specified, mean mood ratings of the participants (the red lines) vary around 5 (the grey dashed line). So far, so good.</p>
<div class="figure" style="text-align: center"><span id="fig:fig9a"></span>
<img src="lmm_files/figure-html/fig9a-1.png" alt="Simulated EMA data of Six Participants." width="100%" />
<p class="caption">
Figure 9.1: Simulated EMA data of Six Participants.
</p>
</div>
</div>
<div id="fitting-a-mixed-model-in-r" class="section level2">
<h2><span class="header-section-number">9.3</span> Fitting a Mixed Model in R</h2>

<p>Now, let’s fit a mixed model to the data, to see whether the simulation parameters are detected. For this, we will use the <code>lme</code> function, from package <code>nlme</code> <span class="citation">(Pinheiro, Bates, DebRoy, Sarkar, &amp; R Core Team, <a href="#ref-R-nlme">2018</a>)</span>. The code snippet below shows how to do this.</p>
<p>The first argument of the lme function, <code>Y ~ 1</code>, specifies the fixed ‘effect’ (in this case: the mean intercept). The second argument, <code>random =~ 1 | id</code> specifies the random effect. In this model, intercepts are allowed to vary between participants. The fitted model is assigned to a variable (‘fm’), which we will use later to study the fitted model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fitting a mixed model with lme.</span>
<span class="kw">library</span>(nlme)
fm &lt;-<span class="st"> </span><span class="kw">lme</span>(Y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id, 
          <span class="dt">data =</span> d1)</code></pre></div>
<p>We can now extract the fixed effects regression coefficients table, by calling the <code>summary</code> function on the fitted model. The estimated intercept should be around 5 (as this is a finite sample, we expect some deviation):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Print fixed effects.</span>
<span class="kw">summary</span>(fm)<span class="op">$</span>tTable
<span class="co">#&gt;             Value Std.Error   DF t-value p-value</span>
<span class="co">#&gt; (Intercept)  5.04    0.0889 2000    56.7       0</span></code></pre></div>
<p>Random effects and residual variance are shown by the <code>VarCorr</code> function. Again, since we specified the data ourselves in this case, we know the ‘true’ value of these parameters: the random intercept variance should be around 1 and the residual error variance should be close to 0.5.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fitted random effects.</span>
<span class="kw">VarCorr</span>(fm)
<span class="co">#&gt; id = pdLogChol(1) </span>
<span class="co">#&gt;             Variance StdDev</span>
<span class="co">#&gt; (Intercept) 0.766    0.875 </span>
<span class="co">#&gt; Residual    0.506    0.711</span></code></pre></div>
<p>It can be instructive to plot the predicted values of the model, to make clear how the model ‘thinks’. As shown by Figure <a href="lmm.html#fig:fig9b">9.2</a>, the model predicts a series of straight lines, one for each participant, that vary around 5 (the red line).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Saving predicted values.</span>
d1<span class="op">$</span>predicted &lt;-<span class="st"> </span><span class="kw">predict</span>(fm)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig9b"></span>
<img src="lmm_files/figure-html/fig9b-1.png" alt="EMA ratings, of each participant in the simulated data set, as predicted by the intercept-only mixed linear model." width="100%" />
<p class="caption">
Figure 9.2: EMA ratings, of each participant in the simulated data set, as predicted by the intercept-only mixed linear model.
</p>
</div>
</div>
<div id="adding-time-as-a-predictor" class="section level2">
<h2><span class="header-section-number">9.4</span> Adding Time as a Predictor</h2>
<p>Now that we know how to fit a simple mixed model, we can consider a more complex scenario. In the first data set, participants’ mood ratings did not change over time. Scores varied around a stable mean during the full week. Hence, there was no need to model a time effect. But suppose we would expect a systematic improvement of mood ratings over time, for instance in response to a mental health intervention?</p>
<p>Let’s first call <code>sim_ema</code> again, with parameters that will result in data in which mood rating increase over the course of the week, 0.5 scale points per day. Let’s also assume that individual participants will vary in the degree of mood improvement: the mean time effect will be 0.5, but this parameter is allowed to vary between participants, with a variance of 0.1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Simulating ema data (time effect).</span>
d2 &lt;-<span class="st"> </span><span class="kw">sim_ema</span>(plan, 
              <span class="dt">mm_par =</span> <span class="kw">list</span>(<span class="dt">fixed  =</span> <span class="kw">c</span>(<span class="dt">intercept =</span> <span class="dv">5</span>, <span class="dt">time =</span> <span class="fl">0.5</span>),
                            <span class="dt">random =</span> <span class="kw">c</span>(<span class="dt">intercept =</span> <span class="dv">1</span>, <span class="dt">time =</span> <span class="fl">0.1</span>),
                            <span class="dt">error =</span> .<span class="dv">5</span>),
              <span class="dt">lim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>))</code></pre></div>
<p>Figure <a href="lmm.html#fig:fig9c">9.3</a> shows the data of the first six participants in the second data set. Both the intercept and the slope vary across the participants. Some participants improve more over time, and others improve less: the slope in this data set is a random effect.</p>
<div class="figure" style="text-align: center"><span id="fig:fig9c"></span>
<img src="lmm_files/figure-html/fig9c-1.png" alt="Simulated EMA data of Six Participants (Time-varying model)." width="100%" />
<p class="caption">
Figure 9.3: Simulated EMA data of Six Participants (Time-varying model).
</p>
</div>
<p>To fit the extended mixed model, time can simply be added to both the fixed and random arguments of the ‘lme’ function. Fixed effects estimated of this model should be around 5 and 0.5, since that is how we specified the data. Calling ‘summary’ on this function, we see that the fixed time effect is significant.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A mixed model, with a random slope.</span>
<span class="kw">library</span>(nlme)
fm &lt;-<span class="st"> </span><span class="kw">lme</span>(Y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>time, <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>time <span class="op">|</span><span class="st"> </span>id, 
          <span class="dt">data =</span> d2)
<span class="kw">summary</span>(fm)<span class="op">$</span>tTable
<span class="co">#&gt;             Value Std.Error   DF t-value   p-value</span>
<span class="co">#&gt; (Intercept) 5.148     0.122 1999    42.2 9.74e-279</span>
<span class="co">#&gt; time        0.483     0.027 1999    17.9  2.33e-66</span></code></pre></div>
<p>The random effects now have four components: the variance of the intercept, the variance of the slope, the residual error <em>and</em> the correlation between the random intercept and the random slope.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Extracting random effects.</span>
<span class="kw">VarCorr</span>(fm)
<span class="co">#&gt; id = pdLogChol(1 + time) </span>
<span class="co">#&gt;             Variance StdDev Corr  </span>
<span class="co">#&gt; (Intercept) 1.3944   1.181  (Intr)</span>
<span class="co">#&gt; time        0.0674   0.260  -0.176</span>
<span class="co">#&gt; Residual    0.4742   0.689</span></code></pre></div>
<p>Model predictions clearly show how the mixed model estimated varying intercepts and slopes, that, on average, approximate the fixed effect regression formula <code>Y = 5 + 0.5 * time</code> that was used to generate the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d2<span class="op">$</span>predicted &lt;-<span class="st"> </span><span class="kw">predict</span>(fm)

<span class="kw">ggplot</span>(d2, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> predicted, <span class="dt">group =</span> id)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> .<span class="dv">1</span>, <span class="dt">size =</span> .<span class="dv">6</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> <span class="ot">NULL</span>), <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_classic</span>()</code></pre></div>
<p><img src="lmm_files/figure-html/fig9d-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="adding-a-two-group-comparison" class="section level2">
<h2><span class="header-section-number">9.5</span> Adding a Two-Group Comparison</h2>
<p>In data-set 1, mood ratings did not change during the week, while in data-set 2, the mood ratings increased. Suppose the two data-sets reflect the data that you collect in a two-group RCT, in which you compare the effects of a mental health intervention (data-set 2) against a waiting list condition (data-set 1). By combining the two data-sets, we can illustrate how to conduct a group comparison with ‘lme’.</p>
<p>Since the two data-sets are already available (in d1 and d2), the new data set can be created with just three lines of code (below). In the first line, the ‘rbind’ function is used to combine the rows of data-set 1 and 2 into a new variable: d3. The second line adds a group indicator to d3. The third line updates the ids of the participants in the second group, to differentiate the participants in the second group from the participants in the first group.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Two-group simulation.</span>
d3 &lt;-<span class="st"> </span><span class="kw">rbind</span>(d1, d2)
d3<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="kw">nrow</span>(d1)), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(d2))), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;treatment&quot;</span>))
d3<span class="op">$</span>id[d3<span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;treatment&quot;</span>] &lt;-<span class="st"> </span>d3<span class="op">$</span>id[d3<span class="op">$</span>group <span class="op">==</span><span class="st"> &quot;treatment&quot;</span>] <span class="op">+</span><span class="st"> </span><span class="dv">100</span></code></pre></div>
<p>The effect of the intervention can be tested by adding a (fixed) ‘time * group’ interaction effect to the model. This effect, we know, is .5, and, as can be seen, this is what the model picks up:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A mixed model, with two groups.</span>
<span class="kw">library</span>(nlme)
fm &lt;-<span class="st"> </span><span class="kw">lme</span>(Y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>time <span class="op">*</span><span class="st"> </span>group, <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>time <span class="op">|</span><span class="st"> </span>id, 
          <span class="dt">data =</span> d3)
<span class="kw">round</span>(<span class="kw">summary</span>(fm)<span class="op">$</span>tTable, <span class="dv">2</span>)
<span class="co">#&gt;                     Value Std.Error   DF t-value p-value</span>
<span class="co">#&gt; (Intercept)          5.05      0.11 3998   46.51    0.00</span>
<span class="co">#&gt; time                 0.00      0.02 3998   -0.08    0.94</span>
<span class="co">#&gt; grouptreatment       0.10      0.15  198    0.65    0.51</span>
<span class="co">#&gt; time:grouptreatment  0.48      0.03 3998   17.15    0.00</span></code></pre></div>
<p>In Figure <a href="lmm.html#fig:fig9e">9.4</a> below, EMA mood ratings predicted by the fitted model show how the model detects 1) the fixed between-group effect, and 2) the variance in intercepts and slopes in both groups.</p>
<div class="figure" style="text-align: center"><span id="fig:fig9e"></span>
<img src="lmm_files/figure-html/fig9e-1.png" alt="Predicted mood ratings" width="100%" />
<p class="caption">
Figure 9.4: Predicted mood ratings
</p>
</div>
</div>
<div id="next-steps" class="section level2">
<h2><span class="header-section-number">9.6</span> Next Steps</h2>
<p>In this chapter, we introduced mixed model analysis of EMA data in R. To do so, we could only touch upon the theoretical foundations of mixed models, and we deliberately used simple examples with clean simulated data. Readers, who consider the application of mixed models, are strongly advised to study additional resources.</p>
<p>The authoritative reference for mixed effect modeling in R is a book by Pinheiro and Bates <span class="citation">(<a href="#ref-Pinheiro2000">2000</a>)</span>. To fully appreciate this book, however, a strong background in mathematical statistics is required. Thorough introductions in the topic are further found in the work of Prof. dr. Jos Twisk <span class="citation">(Twisk, <a href="#ref-twisk2006">2006</a>, <a href="#ref-twisk2013">2013</a>)</span>, who also teaches an applied mixed models course at the Department of Epidemiology and Biostatistics at the Vrije Universiteit Medical Center (see: <a href="http://epidm.nl/en/courses/mixed-models/" class="uri">http://epidm.nl/en/courses/mixed-models/</a>).</p>

</div>
</div>



<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R-nlme">
<p>Pinheiro, J., Bates, D., DebRoy, S., Sarkar, D., &amp; R Core Team. (2018). <em>nlme: Linear and nonlinear mixed effects models</em>. Retrieved from <a href="https://CRAN.R-project.org/package=nlme" class="uri">https://CRAN.R-project.org/package=nlme</a></p>
</div>
<div id="ref-Pinheiro2000">
<p>Pinheiro, J., &amp; Bates, D. M. (2000). <em>Mixed effects models in S and S-Plus</em>. New York: Springer Verlag. <a href="https://doi.org/10.1198/tech.2001.s574" class="uri">https://doi.org/10.1198/tech.2001.s574</a></p>
</div>
<div id="ref-twisk2006">
<p>Twisk, J. (2006). <em>Applied multilevel analysis: A practical guide</em>. Cambridge University Press.</p>
</div>
<div id="ref-twisk2013">
<p>Twisk, J. (2013). <em>Applied longitudinal data analysis for epidemiology: A practical guide (2nd revised edition)</em>. Cambridge University Press.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="features.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="csd.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["aph_ema.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
