<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Ecological Momentary Assessment in Mental Health Research</title>
  <meta name="description" content="This is an Amsterdam Public Health (APH) Research Manual, written for researchers who are planning Ecological Momentary Assessment (EMA) studies.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Ecological Momentary Assessment in Mental Health Research" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/cover/smallcover.jpg" />
  <meta property="og:description" content="This is an Amsterdam Public Health (APH) Research Manual, written for researchers who are planning Ecological Momentary Assessment (EMA) studies." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Ecological Momentary Assessment in Mental Health Research" />
  
  <meta name="twitter:description" content="This is an Amsterdam Public Health (APH) Research Manual, written for researchers who are planning Ecological Momentary Assessment (EMA) studies." />
  <meta name="twitter:image" content="images/cover/smallcover.jpg" />

<meta name="author" content="Jeroen Ruwaard">
<meta name="author" content="Lisa Kooistra">
<meta name="author" content="Melissa Thong">


<meta name="date" content="2018-11-22">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="ema-instruments-catalogue.html">
<link rel="next" href="acknowledgements.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37468015-2', 'auto');
  ga('send', 'pageview');
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; }
td.sourceCode { padding-left: 5px; }
code > span.kw { font-weight: bold; } /* Keyword */
code > span.dt { text-decoration: underline; } /* DataType */
code > span.co { font-style: italic; } /* Comment */
code > span.al { font-weight: bold; } /* Alert */
code > span.er { font-weight: bold; } /* Error */
code > span.wa { font-style: italic; } /* Warning */
code > span.cf { font-weight: bold; } /* ControlFlow */
code > span.pp { font-weight: bold; } /* Preprocessor */
code > span.do { font-style: italic; } /* Documentation */
code > span.an { font-style: italic; } /* Annotation */
code > span.cv { font-style: italic; } /* CommentVar */
code > span.in { font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EMA research Manual</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introducing EMA</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-is-ema"><i class="fa fa-check"></i><b>1.1</b> What is EMA?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="introduction.html"><a href="introduction.html#active-versus-passive-ema"><i class="fa fa-check"></i><b>1.1.1</b> Active versus Passive EMA</a></li>
<li class="chapter" data-level="1.1.2" data-path="introduction.html"><a href="introduction.html#ema-sampling"><i class="fa fa-check"></i><b>1.1.2</b> EMA Sampling</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#why-ema"><i class="fa fa-check"></i><b>1.2</b> Why EMA?</a><ul>
<li class="chapter" data-level="1.2.1" data-path="introduction.html"><a href="introduction.html#to-minimize-recall-bias"><i class="fa fa-check"></i><b>1.2.1</b> To Minimize Recall Bias</a></li>
<li class="chapter" data-level="1.2.2" data-path="introduction.html"><a href="introduction.html#to-maximize-ecological-validity"><i class="fa fa-check"></i><b>1.2.2</b> To Maximize Ecological Validity</a></li>
<li class="chapter" data-level="1.2.3" data-path="introduction.html"><a href="introduction.html#to-advance-ideographic-research"><i class="fa fa-check"></i><b>1.2.3</b> To Advance Ideographic Research</a></li>
<li class="chapter" data-level="1.2.4" data-path="introduction.html"><a href="introduction.html#to-understand-the-dynamic-interplay-between-symptoms"><i class="fa fa-check"></i><b>1.2.4</b> To Understand the Dynamic Interplay between Symptoms</a></li>
<li class="chapter" data-level="1.2.5" data-path="introduction.html"><a href="introduction.html#to-enable-emi"><i class="fa fa-check"></i><b>1.2.5</b> To Enable EMI</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#ema-research-findings-a-birds-eye-view"><i class="fa fa-check"></i><b>1.3</b> EMA Research Findings: A Birds-eye View</a><ul>
<li class="chapter" data-level="1.3.1" data-path="introduction.html"><a href="introduction.html#active-ema"><i class="fa fa-check"></i><b>1.3.1</b> Active EMA</a></li>
<li class="chapter" data-level="1.3.2" data-path="introduction.html"><a href="introduction.html#passive-ema"><i class="fa fa-check"></i><b>1.3.2</b> Passive EMA</a></li>
<li class="chapter" data-level="1.3.3" data-path="introduction.html"><a href="introduction.html#limitations"><i class="fa fa-check"></i><b>1.3.3</b> Limitations</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-is-in-this-manual"><i class="fa fa-check"></i><b>1.4</b> What is in this Manual?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rstudio.html"><a href="rstudio.html"><i class="fa fa-check"></i><b>2</b> Introducing R &amp; RStudio</a><ul>
<li class="chapter" data-level="2.1" data-path="rstudio.html"><a href="rstudio.html#what-are-r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> What are R and RStudio?</a></li>
<li class="chapter" data-level="2.2" data-path="rstudio.html"><a href="rstudio.html#why-r"><i class="fa fa-check"></i><b>2.2</b> Why R?</a></li>
<li class="chapter" data-level="2.3" data-path="rstudio.html"><a href="rstudio.html#installing-r-rstudio"><i class="fa fa-check"></i><b>2.3</b> Installing R &amp; RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="rstudio.html"><a href="rstudio.html#interacting-with-r-through-the-rstudio-console"><i class="fa fa-check"></i><b>2.4</b> Interacting with R through the RStudio Console</a></li>
<li class="chapter" data-level="2.5" data-path="rstudio.html"><a href="rstudio.html#writing-r-scripts"><i class="fa fa-check"></i><b>2.5</b> Writing R-scripts</a></li>
<li class="chapter" data-level="2.6" data-path="rstudio.html"><a href="rstudio.html#importing-your-data"><i class="fa fa-check"></i><b>2.6</b> Importing Your Data</a><ul>
<li class="chapter" data-level="2.6.1" data-path="rstudio.html"><a href="rstudio.html#using-rstudio-menus-to-import-data"><i class="fa fa-check"></i><b>2.6.1</b> Using RStudio Menus to Import Data</a></li>
<li class="chapter" data-level="2.6.2" data-path="rstudio.html"><a href="rstudio.html#using-functions-to-import-data"><i class="fa fa-check"></i><b>2.6.2</b> Using Functions to Import Data</a></li>
<li class="chapter" data-level="2.6.3" data-path="rstudio.html"><a href="rstudio.html#accessing-your-data"><i class="fa fa-check"></i><b>2.6.3</b> Accessing your Data</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="rstudio.html"><a href="rstudio.html#extending-r-with-packages"><i class="fa fa-check"></i><b>2.7</b> Extending R with Packages</a><ul>
<li class="chapter" data-level="2.7.1" data-path="rstudio.html"><a href="rstudio.html#installing-r-packages-from-cran"><i class="fa fa-check"></i><b>2.7.1</b> Installing R-packages from CRAN</a></li>
<li class="chapter" data-level="2.7.2" data-path="rstudio.html"><a href="rstudio.html#installing-r-packages-from-github"><i class="fa fa-check"></i><b>2.7.2</b> Installing R-packages from GitHub</a></li>
<li class="chapter" data-level="2.7.3" data-path="rstudio.html"><a href="rstudio.html#using-packages"><i class="fa fa-check"></i><b>2.7.3</b> Using Packages</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="rstudio.html"><a href="rstudio.html#getting-help"><i class="fa fa-check"></i><b>2.8</b> Getting Help</a><ul>
<li class="chapter" data-level="2.8.1" data-path="rstudio.html"><a href="rstudio.html#using-to-consult-the-documentation"><i class="fa fa-check"></i><b>2.8.1</b> Using ‘?’ to Consult the Documentation</a></li>
<li class="chapter" data-level="2.8.2" data-path="rstudio.html"><a href="rstudio.html#using-rstudios-global-documentation-index-search"><i class="fa fa-check"></i><b>2.8.2</b> Using RStudio’s Global Documentation Index Search</a></li>
<li class="chapter" data-level="2.8.3" data-path="rstudio.html"><a href="rstudio.html#learning-from-examples"><i class="fa fa-check"></i><b>2.8.3</b> Learning from Examples</a></li>
<li class="chapter" data-level="2.8.4" data-path="rstudio.html"><a href="rstudio.html#google"><i class="fa fa-check"></i><b>2.8.4</b> Google</a></li>
<li class="chapter" data-level="2.8.5" data-path="rstudio.html"><a href="rstudio.html#read-books"><i class="fa fa-check"></i><b>2.8.5</b> Read Books</a></li>
<li class="chapter" data-level="2.8.6" data-path="rstudio.html"><a href="rstudio.html#online-courses"><i class="fa fa-check"></i><b>2.8.6</b> Online Courses</a></li>
<li class="chapter" data-level="2.8.7" data-path="rstudio.html"><a href="rstudio.html#learn-r-in-r"><i class="fa fa-check"></i><b>2.8.7</b> Learn R, in R</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II EMA Methods</b></span></li>
<li class="chapter" data-level="3" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>3</b> Study Design</a><ul>
<li class="chapter" data-level="3.1" data-path="methods.html"><a href="methods.html#what-is-the-ema-research-question"><i class="fa fa-check"></i><b>3.1</b> What is the EMA Research Question?</a></li>
<li class="chapter" data-level="3.2" data-path="methods.html"><a href="methods.html#who-are-the-study-participants"><i class="fa fa-check"></i><b>3.2</b> Who are the Study Participants?</a></li>
<li class="chapter" data-level="3.3" data-path="methods.html"><a href="methods.html#what-are-the-qualities-of-the-ema-measures"><i class="fa fa-check"></i><b>3.3</b> What are the Qualities of the EMA Measures?</a></li>
<li class="chapter" data-level="3.4" data-path="methods.html"><a href="methods.html#what-is-the-sample-plan"><i class="fa fa-check"></i><b>3.4</b> What is the Sample Plan?</a></li>
<li class="chapter" data-level="3.5" data-path="methods.html"><a href="methods.html#what-is-the-optimal-sample-size"><i class="fa fa-check"></i><b>3.5</b> What is the Optimal Sample Size?</a></li>
<li class="chapter" data-level="3.6" data-path="methods.html"><a href="methods.html#what-are-the-ethical-aspects"><i class="fa fa-check"></i><b>3.6</b> What are the Ethical Aspects?</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="datamanagement.html"><a href="datamanagement.html"><i class="fa fa-check"></i><b>4</b> Data Management</a><ul>
<li class="chapter" data-level="4.1" data-path="datamanagement.html"><a href="datamanagement.html#using-rstudio-projects"><i class="fa fa-check"></i><b>4.1</b> Using RStudio-projects</a></li>
<li class="chapter" data-level="4.2" data-path="datamanagement.html"><a href="datamanagement.html#an-example-project-directory-structure"><i class="fa fa-check"></i><b>4.2</b> An Example Project Directory Structure</a></li>
<li class="chapter" data-level="4.3" data-path="datamanagement.html"><a href="datamanagement.html#data"><i class="fa fa-check"></i><b>4.3</b> Data</a></li>
<li class="chapter" data-level="4.4" data-path="datamanagement.html"><a href="datamanagement.html#import-scripts"><i class="fa fa-check"></i><b>4.4</b> Import Scripts</a></li>
<li class="chapter" data-level="4.5" data-path="datamanagement.html"><a href="datamanagement.html#cleaning"><i class="fa fa-check"></i><b>4.5</b> Cleaning</a></li>
<li class="chapter" data-level="4.6" data-path="datamanagement.html"><a href="datamanagement.html#pre-process"><i class="fa fa-check"></i><b>4.6</b> Pre-process</a></li>
<li class="chapter" data-level="4.7" data-path="datamanagement.html"><a href="datamanagement.html#combine"><i class="fa fa-check"></i><b>4.7</b> Combine</a></li>
<li class="chapter" data-level="4.8" data-path="datamanagement.html"><a href="datamanagement.html#reproducible-analyses"><i class="fa fa-check"></i><b>4.8</b> Reproducible Analyses</a></li>
<li class="chapter" data-level="4.9" data-path="datamanagement.html"><a href="datamanagement.html#documentation"><i class="fa fa-check"></i><b>4.9</b> Documentation</a><ul>
<li class="chapter" data-level="4.9.1" data-path="datamanagement.html"><a href="datamanagement.html#protocol"><i class="fa fa-check"></i><b>4.9.1</b> Protocol</a></li>
<li class="chapter" data-level="4.9.2" data-path="datamanagement.html"><a href="datamanagement.html#readme"><i class="fa fa-check"></i><b>4.9.2</b> README</a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="datamanagement.html"><a href="datamanagement.html#discussion"><i class="fa fa-check"></i><b>4.10</b> Discussion</a></li>
</ul></li>
<li class="part"><span><b>III EMA Outcomes</b></span></li>
<li class="chapter" data-level="5" data-path="mood.html"><a href="mood.html"><i class="fa fa-check"></i><b>5</b> Mood</a><ul>
<li class="chapter" data-level="5.1" data-path="mood.html"><a href="mood.html#unidimensional-mood-assessment"><i class="fa fa-check"></i><b>5.1</b> Unidimensional Mood Assessment</a><ul>
<li class="chapter" data-level="5.1.1" data-path="mood.html"><a href="mood.html#bipolar-unidimensional-items"><i class="fa fa-check"></i><b>5.1.1</b> Bipolar Unidimensional Items</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="mood.html"><a href="mood.html#bag-of-items"><i class="fa fa-check"></i><b>5.2</b> Bag-of-Items</a></li>
<li class="chapter" data-level="5.3" data-path="mood.html"><a href="mood.html#multi-dimensional-mood-assessment"><i class="fa fa-check"></i><b>5.3</b> Multi-dimensional Mood Assessment</a><ul>
<li class="chapter" data-level="5.3.1" data-path="mood.html"><a href="mood.html#the-circumplex-model"><i class="fa fa-check"></i><b>5.3.1</b> The Circumplex Model</a></li>
<li class="chapter" data-level="5.3.2" data-path="mood.html"><a href="mood.html#negative-positive-affect"><i class="fa fa-check"></i><b>5.3.2</b> Negative &amp; Positive Affect</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="activity.html"><a href="activity.html"><i class="fa fa-check"></i><b>6</b> Activity</a><ul>
<li class="chapter" data-level="6.1" data-path="activity.html"><a href="activity.html#actigraphy"><i class="fa fa-check"></i><b>6.1</b> Actigraphy</a><ul>
<li class="chapter" data-level="6.1.1" data-path="activity.html"><a href="activity.html#data-cleaning"><i class="fa fa-check"></i><b>6.1.1</b> Data cleaning</a></li>
<li class="chapter" data-level="6.1.2" data-path="activity.html"><a href="activity.html#feature-extraction"><i class="fa fa-check"></i><b>6.1.2</b> Feature Extraction</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="activity.html"><a href="activity.html#geotracking"><i class="fa fa-check"></i><b>6.2</b> Geotracking</a><ul>
<li class="chapter" data-level="6.2.1" data-path="activity.html"><a href="activity.html#the-geographic-coordinate-system"><i class="fa fa-check"></i><b>6.2.1</b> The Geographic Coordinate System</a></li>
<li class="chapter" data-level="6.2.2" data-path="activity.html"><a href="activity.html#the-global-positioning-system"><i class="fa fa-check"></i><b>6.2.2</b> The Global Positioning System</a></li>
<li class="chapter" data-level="6.2.3" data-path="activity.html"><a href="activity.html#gps-based-activity-measures"><i class="fa fa-check"></i><b>6.2.3</b> GPS-based Activity Measures</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Analytic Approaches</b></span></li>
<li class="chapter" data-level="7" data-path="features.html"><a href="features.html"><i class="fa fa-check"></i><b>7</b> Feature Extraction</a><ul>
<li class="chapter" data-level="7.1" data-path="features.html"><a href="features.html#simulated-ema-time-series-example"><i class="fa fa-check"></i><b>7.1</b> Simulated EMA Time-series Example</a></li>
<li class="chapter" data-level="7.2" data-path="features.html"><a href="features.html#central-tendency-and-variability"><i class="fa fa-check"></i><b>7.2</b> Central Tendency and Variability</a></li>
<li class="chapter" data-level="7.3" data-path="features.html"><a href="features.html#modeling-the-trend"><i class="fa fa-check"></i><b>7.3</b> Modeling the Trend</a></li>
<li class="chapter" data-level="7.4" data-path="features.html"><a href="features.html#missing-values"><i class="fa fa-check"></i><b>7.4</b> Missing Values</a></li>
<li class="chapter" data-level="7.5" data-path="features.html"><a href="features.html#auto-correlation"><i class="fa fa-check"></i><b>7.5</b> Auto-correlation</a></li>
<li class="chapter" data-level="7.6" data-path="features.html"><a href="features.html#rolling-statistics"><i class="fa fa-check"></i><b>7.6</b> Rolling Statistics</a></li>
<li class="chapter" data-level="7.7" data-path="features.html"><a href="features.html#periodicity"><i class="fa fa-check"></i><b>7.7</b> Periodicity</a></li>
<li class="chapter" data-level="7.8" data-path="features.html"><a href="features.html#discussion-1"><i class="fa fa-check"></i><b>7.8</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="lmm.html"><a href="lmm.html"><i class="fa fa-check"></i><b>8</b> Mixed Modeling</a><ul>
<li class="chapter" data-level="8.1" data-path="lmm.html"><a href="lmm.html#the-mixed-model"><i class="fa fa-check"></i><b>8.1</b> The Mixed Model</a></li>
<li class="chapter" data-level="8.2" data-path="lmm.html"><a href="lmm.html#simulating-example-data"><i class="fa fa-check"></i><b>8.2</b> Simulating Example Data</a></li>
<li class="chapter" data-level="8.3" data-path="lmm.html"><a href="lmm.html#fitting-a-mixed-model-in-r"><i class="fa fa-check"></i><b>8.3</b> Fitting a Mixed Model in R</a></li>
<li class="chapter" data-level="8.4" data-path="lmm.html"><a href="lmm.html#adding-time-as-a-predictor"><i class="fa fa-check"></i><b>8.4</b> Adding Time as a Predictor</a></li>
<li class="chapter" data-level="8.5" data-path="lmm.html"><a href="lmm.html#adding-a-two-group-comparison"><i class="fa fa-check"></i><b>8.5</b> Adding a Two-Group Comparison</a></li>
<li class="chapter" data-level="8.6" data-path="lmm.html"><a href="lmm.html#next-steps"><i class="fa fa-check"></i><b>8.6</b> Next Steps</a></li>
</ul></li>
<li class="part"><span><b>V A Case Study</b></span></li>
<li class="chapter" data-level="9" data-path="csd.html"><a href="csd.html"><i class="fa fa-check"></i><b>9</b> Early Warning Signs of Depression</a><ul>
<li class="chapter" data-level="9.1" data-path="csd.html"><a href="csd.html#critical-slowing-down"><i class="fa fa-check"></i><b>9.1</b> Critical Slowing Down</a></li>
<li class="chapter" data-level="9.2" data-path="csd.html"><a href="csd.html#plotting-the-course-of-depression"><i class="fa fa-check"></i><b>9.2</b> Plotting the Course of Depression</a></li>
<li class="chapter" data-level="9.3" data-path="csd.html"><a href="csd.html#mental-state-ema-items"><i class="fa fa-check"></i><b>9.3</b> Mental state EMA Items</a></li>
<li class="chapter" data-level="9.4" data-path="csd.html"><a href="csd.html#running-the-dfa"><i class="fa fa-check"></i><b>9.4</b> Running the DFA</a></li>
<li class="chapter" data-level="9.5" data-path="csd.html"><a href="csd.html#results"><i class="fa fa-check"></i><b>9.5</b> Results</a></li>
<li class="chapter" data-level="9.6" data-path="csd.html"><a href="csd.html#discussion-2"><i class="fa fa-check"></i><b>9.6</b> Discussion</a></li>
</ul></li>
<li class="part"><span><b>VI EMA Catalogues</b></span></li>
<li class="chapter" data-level="10" data-path="catalogue.html"><a href="catalogue.html"><i class="fa fa-check"></i><b>10</b> EMA Research within the APH Mental Health Consortium</a><ul>
<li class="chapter" data-level="10.1" data-path="catalogue.html"><a href="catalogue.html#depression"><i class="fa fa-check"></i><b>10.1</b> Depression</a><ul>
<li class="chapter" data-level="10.1.1" data-path="catalogue.html"><a href="catalogue.html#bockting"><i class="fa fa-check"></i><b>10.1.1</b> Bockting</a></li>
<li class="chapter" data-level="10.1.2" data-path="catalogue.html"><a href="catalogue.html#penninx-and-lamers"><i class="fa fa-check"></i><b>10.1.2</b> Penninx and Lamers</a></li>
<li class="chapter" data-level="10.1.3" data-path="catalogue.html"><a href="catalogue.html#riper-and-smit"><i class="fa fa-check"></i><b>10.1.3</b> Riper and Smit</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="catalogue.html"><a href="catalogue.html#psychosomatic-symptoms"><i class="fa fa-check"></i><b>10.2</b> Psychosomatic Symptoms</a><ul>
<li class="chapter" data-level="10.2.1" data-path="catalogue.html"><a href="catalogue.html#knoop"><i class="fa fa-check"></i><b>10.2.1</b> Knoop</a></li>
<li class="chapter" data-level="10.2.2" data-path="catalogue.html"><a href="catalogue.html#sprangers"><i class="fa fa-check"></i><b>10.2.2</b> Sprangers</a></li>
<li class="chapter" data-level="10.2.3" data-path="catalogue.html"><a href="catalogue.html#snoek"><i class="fa fa-check"></i><b>10.2.3</b> Snoek</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="catalogue.html"><a href="catalogue.html#suicidal-ideation"><i class="fa fa-check"></i><b>10.3</b> Suicidal Ideation</a><ul>
<li class="chapter" data-level="10.3.1" data-path="catalogue.html"><a href="catalogue.html#van-ballegooijen"><i class="fa fa-check"></i><b>10.3.1</b> Van Ballegooijen</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="catalogue.html"><a href="catalogue.html#psychotic-symptoms"><i class="fa fa-check"></i><b>10.4</b> Psychotic symptoms</a><ul>
<li class="chapter" data-level="10.4.1" data-path="catalogue.html"><a href="catalogue.html#van-der-gaag"><i class="fa fa-check"></i><b>10.4.1</b> Van der Gaag</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="catalogue.html"><a href="catalogue.html#sleep"><i class="fa fa-check"></i><b>10.5</b> Sleep</a><ul>
<li class="chapter" data-level="10.5.1" data-path="catalogue.html"><a href="catalogue.html#van-someren"><i class="fa fa-check"></i><b>10.5.1</b> Van Someren</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="catalogue.html"><a href="catalogue.html#stress-emotion"><i class="fa fa-check"></i><b>10.6</b> Stress &amp; Emotion</a><ul>
<li class="chapter" data-level="10.6.1" data-path="catalogue.html"><a href="catalogue.html#de-geus"><i class="fa fa-check"></i><b>10.6.1</b> De Geus</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html"><i class="fa fa-check"></i><b>11</b> EMA Instruments Catalogue</a><ul>
<li class="chapter" data-level="11.1" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#ema-platforms-apps"><i class="fa fa-check"></i><b>11.1</b> EMA Platforms &amp; Apps</a><ul>
<li class="chapter" data-level="11.1.1" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#ilumivu"><i class="fa fa-check"></i><b>11.1.1</b> Ilumivu</a></li>
<li class="chapter" data-level="11.1.2" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#moodbuster"><i class="fa fa-check"></i><b>11.1.2</b> Moodbuster</a></li>
<li class="chapter" data-level="11.1.3" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#movisens"><i class="fa fa-check"></i><b>11.1.3</b> Movisens</a></li>
<li class="chapter" data-level="11.1.4" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#psymate"><i class="fa fa-check"></i><b>11.1.4</b> PsyMate</a></li>
<li class="chapter" data-level="11.1.5" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#roqua"><i class="fa fa-check"></i><b>11.1.5</b> RoQua</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#wearables"><i class="fa fa-check"></i><b>11.2</b> Wearables</a><ul>
<li class="chapter" data-level="11.2.1" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#geneactiv"><i class="fa fa-check"></i><b>11.2.1</b> GENEActiv</a></li>
<li class="chapter" data-level="11.2.2" data-path="ema-instruments-catalogue.html"><a href="ema-instruments-catalogue.html#vu-ams"><i class="fa fa-check"></i><b>11.2.2</b> VU-AMS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="rcat.html"><a href="rcat.html"><i class="fa fa-check"></i><b>12</b> R Packages for EMA Research</a><ul>
<li class="chapter" data-level="12.1" data-path="rcat.html"><a href="rcat.html#actigraphy-1"><i class="fa fa-check"></i><b>12.1</b> Actigraphy</a><ul>
<li class="chapter" data-level="12.1.1" data-path="rcat.html"><a href="rcat.html#genearead"><i class="fa fa-check"></i><b>12.1.1</b> GENEAread</a></li>
<li class="chapter" data-level="12.1.2" data-path="rcat.html"><a href="rcat.html#ggir"><i class="fa fa-check"></i><b>12.1.2</b> GGIR</a></li>
<li class="chapter" data-level="12.1.3" data-path="rcat.html"><a href="rcat.html#physicalactivity"><i class="fa fa-check"></i><b>12.1.3</b> PhysicalActivity</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="rcat.html"><a href="rcat.html#autoregressive-modeling"><i class="fa fa-check"></i><b>12.2</b> Autoregressive modeling</a><ul>
<li class="chapter" data-level="12.2.1" data-path="rcat.html"><a href="rcat.html#autovarcore"><i class="fa fa-check"></i><b>12.2.1</b> autovarCore</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="rcat.html"><a href="rcat.html#data-management-visual-exploration"><i class="fa fa-check"></i><b>12.3</b> Data management &amp; Visual Exploration</a><ul>
<li class="chapter" data-level="12.3.1" data-path="rcat.html"><a href="rcat.html#dplyr"><i class="fa fa-check"></i><b>12.3.1</b> dplyr</a></li>
<li class="chapter" data-level="12.3.2" data-path="rcat.html"><a href="rcat.html#ggplot2"><i class="fa fa-check"></i><b>12.3.2</b> ggplot2</a></li>
<li class="chapter" data-level="12.3.3" data-path="rcat.html"><a href="rcat.html#haven"><i class="fa fa-check"></i><b>12.3.3</b> haven</a></li>
<li class="chapter" data-level="12.3.4" data-path="rcat.html"><a href="rcat.html#lubridate"><i class="fa fa-check"></i><b>12.3.4</b> lubridate</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="rcat.html"><a href="rcat.html#mixed-effects-modeling"><i class="fa fa-check"></i><b>12.4</b> Mixed-effects Modeling</a><ul>
<li class="chapter" data-level="12.4.1" data-path="rcat.html"><a href="rcat.html#nlme"><i class="fa fa-check"></i><b>12.4.1</b> nlme</a></li>
<li class="chapter" data-level="12.4.2" data-path="rcat.html"><a href="rcat.html#lme4"><i class="fa fa-check"></i><b>12.4.2</b> lme4</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="rcat.html"><a href="rcat.html#simulation"><i class="fa fa-check"></i><b>12.5</b> Simulation</a><ul>
<li class="chapter" data-level="12.5.1" data-path="rcat.html"><a href="rcat.html#simr"><i class="fa fa-check"></i><b>12.5.1</b> simr</a></li>
<li class="chapter" data-level="12.5.2" data-path="rcat.html"><a href="rcat.html#simstudy"><i class="fa fa-check"></i><b>12.5.2</b> simstudy</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="rcat.html"><a href="rcat.html#symptom-network-analysis"><i class="fa fa-check"></i><b>12.6</b> Symptom Network Analysis</a><ul>
<li class="chapter" data-level="12.6.1" data-path="rcat.html"><a href="rcat.html#qgraph"><i class="fa fa-check"></i><b>12.6.1</b> qgraph</a></li>
<li class="chapter" data-level="12.6.2" data-path="rcat.html"><a href="rcat.html#bootnet"><i class="fa fa-check"></i><b>12.6.2</b> bootnet</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="rcat.html"><a href="rcat.html#timeseries-analysis"><i class="fa fa-check"></i><b>12.7</b> Timeseries analysis</a><ul>
<li class="chapter" data-level="12.7.1" data-path="rcat.html"><a href="rcat.html#lomb"><i class="fa fa-check"></i><b>12.7.1</b> lomb</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>VII Closing Matters</b></span></li>
<li class="chapter" data-level="" data-path="acknowledgements.html"><a href="acknowledgements.html"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="http://jruwaard.nl" target="blank">Jeroen Ruwaard</a></li>
<li><a href="https://https://www.linkedin.com/in/lisakooistra/?originalSubdomain=nl" target="blank">Lisa Kooistra</a></li>
<li><a href="https://www.linkedin.com/in/melissa-thong-76977331/" target="blank">Melissa Thong</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Ecological Momentary Assessment in Mental Health Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rcat" class="section level1">
<h1><span class="header-section-number">Chapter 12</span> R Packages for EMA Research</h1>
<p>Many R packages exist that can help you in the management and analysis of EMA data. In this chapter, a selection of these packages is discussed. For each, we provide a summary description, example code, and pointers to further documentation, to give you a head start in using these packages for your work.</p>
<table>
<caption><span id="tab:rcat">Table 12.1: </span> List of R packages that are useful in EMA research.</caption>
<colgroup>
<col width="22%" />
<col width="25%" />
<col width="52%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"><strong>Category</strong></th>
<th align="left"><strong>Package</strong></th>
<th align="left"><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Actigraphy</strong></td>
<td align="left">GENEAread</td>
<td align="left">Import GENEActiv data.</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">GGIR</td>
<td align="left">Import, pre-process and analyze accelerometer data.</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">PhysicalActivity</td>
<td align="left">Analyze Actigraph accelerometer data.</td>
</tr>
<tr class="even">
<td align="left"><strong>Data Management &amp; Visual Exploration</strong></td>
<td align="left">dplyr</td>
<td align="left">Data transformation.</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">ggplot2</td>
<td align="left">Create graphs.</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">haven</td>
<td align="left">Import and export SPSS data files.</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">lubridate</td>
<td align="left">Manipulate date and time variables.</td>
</tr>
<tr class="even">
<td align="left"><strong>Auto-regressive modeling</strong></td>
<td align="left">autovarCore</td>
<td align="left">Automate the construction of vector autoregressive models.</td>
</tr>
<tr class="odd">
<td align="left"><strong>Mixed-effects Modeling</strong></td>
<td align="left">lme4</td>
<td align="left">Fit linear and nonlinear mixed-effects models. Fast alternative to package <code>nlme</code>.</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">nlme</td>
<td align="left">Fit linear and nonlinear mixed effects models. Pre-dates package <code>lme4</code>, but is still used because it a provides advanced options to model correlational structures</td>
</tr>
<tr class="odd">
<td align="left"><strong>Simulation</strong></td>
<td align="left">simr</td>
<td align="left">Simulation-based power calculations for mixed models.</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">simstudy</td>
<td align="left">Simulate complex study data.</td>
</tr>
<tr class="odd">
<td align="left"><strong>Symptom Networks</strong></td>
<td align="left">bootnet</td>
<td align="left">Assess the stability of symptom networks.</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">qgraph</td>
<td align="left">Estimate and plot symptom networks.</td>
</tr>
<tr class="odd">
<td align="left"><strong>Time series analysis</strong></td>
<td align="left">lomb</td>
<td align="left">Calculate the Lomb-Scargle Periodogram for unevenly sampled time series.</td>
</tr>
</tbody>
</table>
<div id="actigraphy-1" class="section level2">
<h2><span class="header-section-number">12.1</span> Actigraphy</h2>

<p>Accelerometer data need considerable pre-processing before final analyses can be run. Raw data have to be read in from a variety of brand-specific file formats, data have to re-calibrated on a per-device basis, non-wear periods have to detected, and summarizing measures, such as activity counts and energy-expenditure measures, have to be calculated from imputed triangular (x, y, x) data, often in several time windows (i.e., epochs).</p>
<div id="genearead" class="section level3">
<h3><span class="header-section-number">12.1.1</span> GENEAread</h3>

<p><a href="https://www.geneactiv.org/">GENEActiv</a> is a wrist-worn accelerometer that is widely used in sleep and physical activity research. With package <strong>GENEAread</strong> <span class="citation">(Fang, Langford, &amp; Sweetland, <a href="#ref-R_GENEAread">2018</a>)</span>, raw GENEActiv binary files can be imported into R for further processing, as illustrated below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read raw GENEActiv data.</span>
<span class="kw">library</span>(GENEAread)
dat &lt;-<span class="st"> </span><span class="kw">read.bin</span>(<span class="kw">system.file</span>(<span class="st">&quot;binfile/TESTfile.bin&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;GENEAread&quot;</span>),
                  <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">downsample =</span> <span class="dv">20</span>)
d &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(dat<span class="op">$</span>data.out)
d<span class="op">$</span>timestamp &lt;-<span class="st"> </span><span class="kw">as.POSIXct</span>(d<span class="op">$</span>timestamp, <span class="dt">origin =</span> <span class="st">&quot;1970-01-01&quot;</span>, <span class="dt">tz =</span> <span class="st">&quot;UTC&quot;</span>)
d[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, ]</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">timestamp</th>
<th align="right">x</th>
<th align="right">y</th>
<th align="right">z</th>
<th align="right">light</th>
<th align="right">button</th>
<th align="right">temperature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2012-05-23 16:47:50.0</td>
<td align="right">0.023516</td>
<td align="right">-0.887283</td>
<td align="right">-0.100785</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">25.8</td>
</tr>
<tr class="even">
<td align="left">2012-05-23 16:47:50.2</td>
<td align="right">0.027462</td>
<td align="right">-0.933668</td>
<td align="right">-0.140047</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">25.8</td>
</tr>
<tr class="odd">
<td align="left">2012-05-23 16:47:50.4</td>
<td align="right">0.035354</td>
<td align="right">-1.150135</td>
<td align="right">-0.030114</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">25.8</td>
</tr>
<tr class="even">
<td align="left">2012-05-23 16:47:50.5</td>
<td align="right">0.070865</td>
<td align="right">-3.229764</td>
<td align="right">-0.619042</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">25.8</td>
</tr>
</tbody>
</table>
<p>By having access to the raw data, you are free to explore the data further in any you want. For instance, to plot the raw data captured by each sensor, type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot raw GENEActiv data, with ggplot</span>
<span class="kw">library</span>(ggplot2); <span class="kw">library</span>(tidyr)
d &lt;-<span class="st"> </span><span class="kw">gather</span>(d, <span class="dt">key =</span> <span class="st">&quot;sensor&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;value&quot;</span>, <span class="op">-</span>timestamp)
<span class="kw">ggplot</span>(d, <span class="kw">aes</span>(<span class="dt">x =</span> timestamp, <span class="dt">y =</span> value)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>sensor, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:genearead-plot-example"></span>
<img src="R-package-catalogue_files/figure-html/genearead-plot-example-1.png" alt="Raw sensor data of a GENEActiv accelerometer." width="100%" />
<p class="caption">
Figure 12.1: Raw sensor data of a GENEActiv accelerometer.
</p>
</div>
</div>
<div id="ggir" class="section level3">
<h3><span class="header-section-number">12.1.2</span> GGIR</h3>

<p>Package <em>GGIR</em> <span class="citation">(Van Hees et al., <a href="#ref-R-GGIR">2018</a>)</span> is a package to pre-process raw accelerometry data from three accelerometer brands: <a href="http://actigraphcorp.com/">ActiGraph</a>, <a href="http://axivity.com/">Axivity</a>, and <a href="https://www.geneactiv.org/">GENEActiv</a> (GGIR includes package <code>GENEAread</code>). The package is in active development. New features are introduced and bugs are fixed on a regular basis. If you consider to use <code>GGIR</code> for your project, you may want to install the development version, which is on <a href="https://github.com/wadpac/GGIR">GitHub</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools)
<span class="kw">install_github</span>(<span class="st">&quot;wadpac/GGIR&quot;</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><code>GGIR</code>’s main function is <code>g.shell.GGIR</code>, with which multiple accelerometer data files can be imported, calibrated, cleaned (identify non-wear periods, impute data) and analyzed (extract and summarize variables on physical activity and sleep). The example below shows an example configuration (. See <code>?g.shell.GGIR</code> (and <code>?g.part1</code>, ?<code>g.part2</code>, to <code>g.part4</code>) to learn the meaning of each parameter. If you get lost or run into a problem, you can ask the package developers or other users for help via the GGIR Google discussion forum, at <a href="https://groups.google.com/forum/#!forum/rpackageggir" class="uri">https://groups.google.com/forum/#!forum/rpackageggir</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Import actigraphy data with GGIR</span>
<span class="kw">library</span>(GGIR)

<span class="kw">g.shell.GGIR</span>(
  <span class="co"># Shell configuration ---------------------------</span>
  <span class="dt">mode =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="dt">f1 =</span> <span class="dv">2</span>,
  <span class="dt">datadir =</span> <span class="st">&quot;./data/raw/actigraphy/&quot;</span>, 
  <span class="dt">outputdir =</span> <span class="st">&quot;./data/cleaned/ggir&quot;</span>,
  <span class="dt">desiredtz =</span> <span class="st">&quot;Europe/Amsterdam&quot;</span>,
  <span class="dt">do.report =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>), <span class="dt">visualreport =</span> <span class="ot">TRUE</span>,
  <span class="dt">overwrite =</span> <span class="ot">TRUE</span>,
  <span class="co"># Part 1: import, calibrate, extract features ----</span>
  <span class="dt">do.anglez=</span><span class="ot">TRUE</span>,
  <span class="co"># Part 2: impute and summarize -------------------</span>
  <span class="dt">strategy =</span> <span class="dv">1</span>, <span class="dt">maxdur =</span> <span class="dv">8</span>,
  <span class="dt">hrs.del.start =</span> <span class="dv">0</span>, <span class="dt">hrs.del.end =</span> <span class="dv">0</span>,
  <span class="dt">includedaycrit =</span> <span class="dv">10</span>, <span class="dt">mvpathreshold =</span> <span class="kw">c</span>(<span class="dv">125</span>), 
  <span class="co"># Part 3: Sleep detection</span>
  <span class="dt">timethreshold =</span> <span class="kw">c</span>(<span class="dv">5</span>), <span class="dt">anglethreshold =</span> <span class="dv">5</span>,
  <span class="dt">ignorenonwear =</span> <span class="ot">TRUE</span>,
  <span class="co"># Part 4: sleep summaries ------------------------</span>
  <span class="dt">includenightcrit =</span> <span class="dv">12</span>,
)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:GGIR-pdf"></span>
<img src="images/catalogue_R/GGIR_pdf.png" alt="sample GGIR output" width="100%" />
<p class="caption">
Figure 12.2: sample GGIR output
</p>
</div>
</div>
<div id="physicalactivity" class="section level3">
<h3><span class="header-section-number">12.1.3</span> PhysicalActivity</h3>

<p>Package <em>PhysicalActivity</em> <span class="citation">(Choi, Beck, Liu, Matthews, &amp; Buchowski, <a href="#ref-R-PhysicalActivity">2018</a>)</span> provides an alternative to packages <code>GGIR</code> and <code>GENEAread</code>, when <a href="https://actigraphcorp.com/">ActiGraph</a> data are available.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plotting activity counts.</span>
<span class="kw">library</span>(PhysicalActivity)
<span class="kw">library</span>(ggplot2)

<span class="kw">data</span>(dataSec)

d &lt;-<span class="st"> </span><span class="kw">dataCollapser</span>(dataSec, <span class="dt">TS =</span> <span class="st">&quot;TimeStamp&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;counts&quot;</span>, <span class="dt">by =</span> <span class="dv">300</span>)

<span class="kw">ggplot</span>(d, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">as.POSIXct</span>(TimeStamp), <span class="dt">y =</span> counts)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> .<span class="dv">5</span>, <span class="dt">alpha =</span> .<span class="dv">5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Time&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Activity Counts&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig15a"></span>
<img src="R-package-catalogue_files/figure-html/fig15a-1.png" alt="Activity Counts (5-minute windows), in a Three-day Accelerometer data set." width="100%" />
<p class="caption">
Figure 12.3: Activity Counts (5-minute windows), in a Three-day Accelerometer data set.
</p>
</div>
</div>
</div>
<div id="autoregressive-modeling" class="section level2">
<h2><span class="header-section-number">12.2</span> Autoregressive modeling</h2>
<div id="autovarcore" class="section level3">
<h3><span class="header-section-number">12.2.1</span> autovarCore</h3>
<p> </p>

<p>Vector autoregressive (VAR) models can be used to detect lagged relationships between multiple time-series (see also Chapter <a href="features.html#features">7</a>). In VAR, each variable is modeled as a linear function of past values (lags) of itself and of present and past values of other variables. When EMA is used to capture multiple phenomena over time, VAR can provide insight in how these phenomena interact. One challenge in VAR modeling is that many alternative models potentially exist, Package <em>autovarCore</em> <span class="citation">(Emerencia, <a href="#ref-R-autovarCore">2018</a>)</span> was developed to help researchers to find the VAR model with the best fit to a given time-series data set. In the example below, function <code>autovar</code> is used to detect that changes in depression are positively related to past (lag 1) values of activity, in a simulated data set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Autovar analysis.</span>
<span class="kw">library</span>(autovarCore)

<span class="co"># simulate data</span>
N =<span class="st"> </span><span class="dv">100</span>
depression &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N)
activity &lt;-<span class="st"> </span><span class="kw">rnorm</span>(N)
activity_lag1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="ot">NA</span>, activity[<span class="dv">1</span><span class="op">:</span>(N <span class="op">-</span><span class="dv">1</span>)])

depression &lt;-<span class="st"> </span>depression <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span>activity_lag1 
d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(depression, activity)

models_found &lt;-<span class="st"> </span>autovarCore<span class="op">::</span><span class="kw">autovar</span>(d, <span class="dt">selected_column_names =</span> <span class="kw">c</span>(<span class="st">&#39;activity&#39;</span>, <span class="st">&#39;depression&#39;</span>))

<span class="co"># Show details for the best model found</span>
<span class="kw">summary</span>(models_found[[<span class="dv">1</span>]]<span class="op">$</span>varest<span class="op">$</span>varresult<span class="op">$</span>depression)
<span class="co">#&gt; </span>
<span class="co">#&gt; Call:</span>
<span class="co">#&gt; lm(formula = y ~ -1 + ., data = datares)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residuals:</span>
<span class="co">#&gt;      Min       1Q   Median       3Q      Max </span>
<span class="co">#&gt; -2.81442 -0.50094  0.06734  0.54927  2.49861 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Coefficients:</span>
<span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co">#&gt; activity.l1    0.5813673  0.0925945   6.279 1.11e-08 ***</span>
<span class="co">#&gt; depression.l1 -0.0371659  0.0889408  -0.418   0.6770    </span>
<span class="co">#&gt; depression.l2  0.0152312  0.0901156   0.169   0.8662    </span>
<span class="co">#&gt; const         -0.3052847  0.3337492  -0.915   0.3627    </span>
<span class="co">#&gt; index          0.0273383  0.0148712   1.838   0.0692 .  </span>
<span class="co">#&gt; index2        -0.0003647  0.0001403  -2.598   0.0109 *  </span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Residual standard error: 0.9714 on 92 degrees of freedom</span>
<span class="co">#&gt; Multiple R-squared:  0.368,  Adjusted R-squared:  0.3336 </span>
<span class="co">#&gt; F-statistic: 10.71 on 5 and 92 DF,  p-value: 3.93e-08</span></code></pre></div>
<p><code>AutovarCore</code> is a simplified version of a more extensive package <em>autovar</em> <span class="citation">(Emerencia, <a href="#ref-R-autovarCore">2018</a>)</span>, which was used in several publications <span class="citation">(Emerencia et al., <a href="#ref-Emerencia2016">2016</a>; Van der Krieke et al., <a href="#ref-VanderKrieke2015">2015</a>)</span>. Further information can be found on <a href="https://autovar.nl/">http://autovar.nl</a> and <a href="https://autovarcore.nl/">http://autovarcore.nl</a></p>
</div>
</div>
<div id="data-management-visual-exploration" class="section level2">
<h2><span class="header-section-number">12.3</span> Data management &amp; Visual Exploration</h2>

<p>The <em>tidyverse</em> is a collection of well-designed packages, authored by the team behind RStudio, that together add a consistent, modern, and efficient extension of base R functions. The <code>tidyverse</code> includes popular packages such as <code>ggplot2</code> (for plotting), <code>haven</code> (to read SPSS files), <code>dplyr</code> (for data manipulation), and many more (see: <a href="http://tidyverse.org" class="uri">http://tidyverse.org</a> for a full list).</p>
<div id="dplyr" class="section level3">
<h3><span class="header-section-number">12.3.1</span> dplyr</h3>

<p>Package <em>dplyr</em> <span class="citation">(Wickham, François, Henry, &amp; Müller, <a href="#ref-R-dplyr">2018</a>)</span> implements the ‘split-apply-combine’-strategy. With <code>dplyr</code>, elementary data manipulations can be e chained (using the pipe operator <code>%\&gt;%</code>) to elegantly implement complex data transformations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Aggregate data by ID, through a &#39;pipe&#39;.</span>
<span class="kw">require</span>(dplyr)

d &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">id =</span> <span class="kw">factor</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">each =</span> <span class="dv">10</span>)), 
  <span class="dt">score =</span> <span class="kw">rnorm</span>(<span class="dv">50</span>)
)

b &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(d) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(score))

knitr<span class="op">::</span><span class="kw">kable</span>(b)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">id</th>
<th align="right">mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">-0.4841959</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">-0.2268515</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">0.0650939</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">0.0714066</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="right">0.1296515</td>
</tr>
</tbody>
</table>
<p>A good introduction to <code>dplyr</code> can be found in the book ‘R for Data Science’ <span class="citation">(Wickham &amp; Grolemund, <a href="#ref-wickham2016r">2016</a>)</span>, which can be freely accessed online (<a href="http://r4ds.had.co.nz/" class="uri">http://r4ds.had.co.nz/</a>).</p>
</div>
<div id="ggplot2" class="section level3">
<h3><span class="header-section-number">12.3.2</span> ggplot2</h3>

<p>Package <em>ggplot2</em> <span class="citation">(Wickham, <a href="#ref-wickham2016ggplot2">2016</a>)</span> provides a collection of high-level plotting commands with which graphs can be build up in layers. It is based on ‘The Grammar of Graphics’ <span class="citation">(Wilkinson, <a href="#ref-wilkinson2006">2006</a>)</span>, an influential analysis of the structure of scientific graphs. Systematic introductions are available on the <a href="http://ggplot2.tidyverse.org/">the tidyverse website</a>, and in the book ‘ggplot2: Elegant Graphics for Data Analysis’ <span class="citation">(Wickham, <a href="#ref-wickham2016ggplot2">2016</a>)</span>.</p>
<p>The example below illustrates how graphs are layered. In the first step, a coordinate system is set up. In step 2, all time/scores points are plotted. In step 3, a smoothed line is fitted through these points. Finally, in step 4, the graph is split on a variable ID (a subject identifier), to show individual trajectories.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Simple ggplot example.</span>
<span class="kw">library</span>(ggplot2)

<span class="co"># simulate example data </span>
d =<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">ID    =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">each =</span> <span class="dv">25</span>),
  <span class="dt">time  =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">25</span>, <span class="dv">4</span>), 
  <span class="dt">score =</span> <span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">2</span>))

<span class="co"># step 1: initialise the coordinate system</span>
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(d, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">y =</span> score)); g

<span class="co"># step 2: add scatterplot</span>
g &lt;-<span class="st"> </span>g <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(); g

<span class="co"># step 3: add a smoothed line</span>
g &lt;-<span class="st"> </span>g <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>); g

<span class="co"># step 4: split plot by subject ID</span>
g <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>ID)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:ggplot2-example"></span>
<img src="R-package-catalogue_files/figure-html/ggplot2-example-1.png" alt="Plotting layers with ggplot2" width="45%" /><img src="R-package-catalogue_files/figure-html/ggplot2-example-2.png" alt="Plotting layers with ggplot2" width="45%" /><img src="R-package-catalogue_files/figure-html/ggplot2-example-3.png" alt="Plotting layers with ggplot2" width="45%" /><img src="R-package-catalogue_files/figure-html/ggplot2-example-4.png" alt="Plotting layers with ggplot2" width="45%" />
<p class="caption">
Figure 12.4: Plotting layers with ggplot2
</p>
</div>
</div>
<div id="haven" class="section level3">
<h3><span class="header-section-number">12.3.3</span> haven</h3>
<p> </p>
<p>With package <em>haven</em> <span class="citation">(Wickham &amp; Miller, <a href="#ref-R-haven">2018</a>)</span>, SPSS, STATA and SAS files can be read into R. A particular advantage of the <code>read.sav</code> function is that SPSS variables definitions are retained (in attributes of the columns in the R <code>data.frames</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Read SPSS data</span>
<span class="kw">library</span>(haven)

<span class="co"># read example data (included in package)</span>
path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;examples&quot;</span>, <span class="st">&quot;iris.sav&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;haven&quot;</span>)
d &lt;-<span class="st"> </span><span class="kw">read_sav</span>(path)

<span class="co"># show attributes of variable</span>
<span class="kw">attributes</span>(d<span class="op">$</span>Species)
<span class="co">#&gt; $format.spss</span>
<span class="co">#&gt; [1] &quot;F8.0&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $class</span>
<span class="co">#&gt; [1] &quot;labelled&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $labels</span>
<span class="co">#&gt;     setosa versicolor  virginica </span>
<span class="co">#&gt;          1          2          3</span></code></pre></div>
</div>
<div id="lubridate" class="section level3">
<h3><span class="header-section-number">12.3.4</span> lubridate</h3>
<p> </p>
<p>EMA data analyses frequently require manipulations of date-time variables. For this, package <em>lubridate</em> <span class="citation">(Grolemund &amp; Wickham, <a href="#ref-R-lubridate">2011</a>)</span>, which provides many functions for common date and date time operations, can be very useful.</p>
<p>In the code snippet below, for example, the <code>round_date</code> function is used to calculate the ENMO value from raw tri-axial accelerometer data (see Chapter <a href="activity.html#activity">6</a>), in 15-minute epoch windows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Rounding datetime variables with lubridate.</span>
<span class="kw">library</span>(emaph)
<span class="kw">library</span>(lubridate)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(dplyr)

d &lt;-<span class="st">  </span><span class="kw">subset</span>(geneactiv,
              timestamp <span class="op">&gt;</span><span class="st"> &quot;2018-06-02 12:00&quot;</span> <span class="op">&amp;</span>
<span class="st">              </span>timestamp <span class="op">&lt;</span><span class="st"> &quot;2018-06-02 18:00&quot;</span>)

<span class="co"># round timestamp</span>
d<span class="op">$</span>epoch &lt;-<span class="st"> </span><span class="kw">round_date</span>(d<span class="op">$</span>timestamp, <span class="st">&quot;15 minutes&quot;</span>)

<span class="co"># summarize x, y, z acceleration to ENMO</span>
d &lt;-<span class="st"> </span>d <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(id, epoch) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">svm =</span> <span class="kw">sum</span>(<span class="kw">sqrt</span>(x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>y<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>z<span class="op">^</span><span class="dv">2</span>) <span class="op">-</span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="kw">n</span>())</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">id</th>
<th align="left">epoch</th>
<th align="right">svm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">2018-06-02 12:00:00</td>
<td align="right">0.0235192</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">2018-06-02 12:15:00</td>
<td align="right">0.0486871</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">2018-06-02 12:30:00</td>
<td align="right">0.0477664</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">2018-06-02 12:45:00</td>
<td align="right">0.0128911</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">2018-06-02 13:00:00</td>
<td align="right">0.0005558</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">2018-06-02 13:15:00</td>
<td align="right">0.0027089</td>
</tr>
</tbody>
</table>
<p>To learn more about handling dates and times with <code>lubridate</code>, <a href="http://r4ds.had.co.nz/dates-and-times.html">Chapter 16</a> of the book ‘R for Data Science’ <span class="citation">(Wickham &amp; Grolemund, <a href="#ref-wickham2016r">2016</a>)</span> provides a good introduction.</p>
</div>
</div>
<div id="mixed-effects-modeling" class="section level2">
<h2><span class="header-section-number">12.4</span> Mixed-effects Modeling</h2>

<p>Several R-packages for mixed-effects modeling exist. The most popular are package <em>nlme</em> <span class="citation">(Pinheiro et al., <a href="#ref-R-nlme">2018</a>)</span> and package <em>lme4</em> <span class="citation">(Bates, Mächler, Bolker, &amp; Walker, <a href="#ref-Bates2015">2015</a>)</span>. Both packages are actively used, as both provide unique functionalities.</p>
<div id="nlme" class="section level3">
<h3><span class="header-section-number">12.4.1</span> nlme</h3>

<p>Package <em>nlme</em> is introduced in Chapter <a href="lmm.html#lmm">8</a>. It is an older package (in comparison to <code>lme4</code>), that is still used a lot because it provides options to model correlational structures that are not implemented (yet) in <code>lme4</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit a linear mixed model, with lme.</span>
<span class="kw">library</span>(nlme)
fm &lt;-<span class="st"> </span><span class="kw">lme</span>(distance <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>Sex, <span class="dt">data =</span> Orthodont, <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>)

<span class="kw">fixef</span>(fm)
<span class="co">#&gt; (Intercept)         age   SexFemale </span>
<span class="co">#&gt;  17.7067130   0.6601852  -2.3210227</span></code></pre></div>
</div>
<div id="lme4" class="section level3">
<h3><span class="header-section-number">12.4.2</span> lme4</h3>

<p>Package <em>lme4</em> <span class="citation">(Bates et al., <a href="#ref-Bates2015">2015</a>)</span> is a faster reimplementation of the mixed-effects model. With large data sets and complex hierarchical models, this package should probably be preferred. As can be seen below, model specifications in <code>lmer</code> are different from model specifications in <code>lme</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit a linear mixed model, with lme.</span>
<span class="kw">library</span>(lme4)
fm &lt;-<span class="st"> </span><span class="kw">lmer</span>(distance <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>Sex <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Subject), <span class="dt">data =</span> nlme<span class="op">::</span>Orthodont)

<span class="kw">fixef</span>(fm)
<span class="co">#&gt; (Intercept)         age   SexFemale </span>
<span class="co">#&gt;  17.7067130   0.6601852  -2.3210227</span></code></pre></div>
</div>
</div>
<div id="simulation" class="section level2">
<h2><span class="header-section-number">12.5</span> Simulation</h2>
<div id="simr" class="section level3">
<h3><span class="header-section-number">12.5.1</span> simr</h3>

<p>With package <em>simr</em> <span class="citation">(P. Green &amp; MacLeod, <a href="#ref-Green2016">2016</a>)</span>, power of mixed-effects models can be determined via simulation. As illustrated below, the procedure requires the researcher to define the true parameters of a mixed model, and a single data set. Next, function <code>simPower</code> can be used to simulate new data sets and tests (of a specified parameter in the model), to determine the power of the test.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Power analysis of a two-group repeated measures design</span>
<span class="co"># (simulation approach).</span>
<span class="kw">library</span>(simr)

<span class="co"># construct design matrix </span>
time &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">24</span>
subject &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">40</span>
X   &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">time =</span> time, <span class="dt">subject =</span> subject)
X<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">24</span>), <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">24</span>)) <span class="co"># group</span>

<span class="co"># fixed intercept and slope</span>
b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="op">-</span><span class="fl">0.1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="fl">0.5</span>)

<span class="co"># random intercept variance</span>
V1 &lt;-<span class="st"> </span><span class="fl">0.5</span>                     

<span class="co"># random intercept and slope variance-covariance matrix</span>
V2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>), <span class="dv">2</span>) 

<span class="co"># residual standard deviation</span>
s &lt;-<span class="st"> </span><span class="dv">1</span> 

model1 &lt;-<span class="st"> </span><span class="kw">makeLmer</span>(y <span class="op">~</span><span class="st"> </span>time <span class="op">*</span><span class="st"> </span>group <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>time <span class="op">|</span><span class="st"> </span>subject), 
                   <span class="dt">fixef =</span> b, 
                   <span class="dt">VarCorr =</span> V2, 
                   <span class="dt">sigma =</span> s, 
                   <span class="dt">data =</span> X)

<span class="kw">powerSim</span>(model1, 
         <span class="kw">fixed</span>(<span class="st">&quot;time:group&quot;</span>, <span class="st">&quot;lr&quot;</span>), 
         <span class="dt">nsim =</span> <span class="dv">10</span>, <span class="co"># set to high value for better results</span>
         <span class="dt">progress =</span> <span class="ot">FALSE</span>)
<span class="co">#&gt; Power for predictor &#39;time:group&#39;, (95% confidence interval):</span>
<span class="co">#&gt;       100.0% (69.15, 100.0)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Test: Likelihood ratio</span>
<span class="co">#&gt;       Effect size for time:group is -0.50</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Based on 10 simulations, (0 warnings, 0 errors)</span>
<span class="co">#&gt; alpha = 0.05, nrow = 960</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Time elapsed: 0 h 0 m 2 s</span></code></pre></div>
</div>
<div id="simstudy" class="section level3">
<h3><span class="header-section-number">12.5.2</span> simstudy</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(simstudy)

def &lt;-<span class="st"> </span><span class="kw">defData</span>(<span class="dt">varname =</span> <span class="st">&quot;nr&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;nonrandom&quot;</span>, <span class="dt">formula =</span> <span class="dv">7</span>, <span class="dt">id =</span> <span class="st">&quot;idnum&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;x1&quot;</span>, <span class="dt">dist =</span> <span class="st">&quot;uniform&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;10;20&quot;</span>)
def &lt;-<span class="st"> </span><span class="kw">defData</span>(def, <span class="dt">varname =</span> <span class="st">&quot;y1&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;nr + x1 * 2&quot;</span>, <span class="dt">variance =</span> <span class="dv">8</span>)

<span class="kw">genData</span>(<span class="dv">5</span>, def)
<span class="co">#&gt;    idnum nr       x1       y1</span>
<span class="co">#&gt; 1:     1  7 16.08567 39.47196</span>
<span class="co">#&gt; 2:     2  7 12.46348 32.27785</span>
<span class="co">#&gt; 3:     3  7 17.84386 46.95338</span>
<span class="co">#&gt; 4:     4  7 19.47801 43.35452</span>
<span class="co">#&gt; 5:     5  7 11.26391 29.32974</span></code></pre></div>
</div>
</div>
<div id="symptom-network-analysis" class="section level2">
<h2><span class="header-section-number">12.6</span> Symptom Network Analysis</h2>
<p> </p>
<p>When EMA is used to tap various symptoms, network analysis can reveal the dynamic interplay between these symptoms <span class="citation">(Borsboom, <a href="#ref-Borsboom2017">2017</a>; Borsboom &amp; Cramer, <a href="#ref-Borsboom2013">2013</a>; Bringmann et al., <a href="#ref-Bringmann2015">2015</a>)</span>. Various packages exist to fit these networks in R. With these packages, it is relatively easy to fit a graphical network on multivariate data sets. If you are interested in conducting a network analysis, be sure to visit the Psycho-systems website, at <a href="http://psychosystems.org" class="uri">http://psychosystems.org</a>, or to register for the UvA network school course (see: <a href="http://psychosystems.org/NetworkSchool" class="uri">http://psychosystems.org/NetworkSchool</a>). A complete list of software related to network analysis from the Psycho-systems group is maintained at <a href="http://psychosystems.org/software/" class="uri">http://psychosystems.org/software/</a>. Excellent tutorials can also be found at <a href="http://psych-networks.com/tutorials/" class="uri">http://psych-networks.com/tutorials/</a> and at <a href="http://sachaepskamp.com/files/Cookbook.html" class="uri">http://sachaepskamp.com/files/Cookbook.html</a>.</p>
<div id="qgraph" class="section level3">
<h3><span class="header-section-number">12.6.1</span> qgraph</h3>

<p>Package <em>qgraph</em> <span class="citation">(Epskamp, Cramer, Waldorp, Schmittmann, &amp; Borsboom, <a href="#ref-Epskamp2012">2012</a>)</span> can be used to fit, visualize and analyze graphical networks.</p>
<p>In the example below, <code>qgraph</code> is used to fit a network on the ‘Critical Slowing Down’ (CSD) data set, which is included in package <code>emaph</code> (see Chapter <a href="csd.html#csd">9</a>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fitting a network, with qgraph.</span>

<span class="kw">library</span>(qgraph)
<span class="kw">library</span>(emaph)

<span class="co"># get mood_ scores from csd data set</span>
d &lt;-<span class="st"> </span><span class="kw">subset</span>(csd, 
            <span class="dt">subset =</span> phase <span class="op">==</span><span class="st"> &quot;exp: db: no change&quot;</span>, 
            <span class="dt">select =</span> <span class="kw">grep</span>(<span class="st">&quot;mood_&quot;</span>, <span class="kw">names</span>(csd))[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>])


<span class="co"># Fit and plot regularized partial correlation network</span>
g &lt;-<span class="st"> </span><span class="kw">qgraph</span>(<span class="kw">cor_auto</span>(d, <span class="dt">detectOrdinal =</span> <span class="ot">FALSE</span>),
       <span class="dt">graph =</span> <span class="st">&quot;glasso&quot;</span>, <span class="dt">sampleSize =</span> <span class="kw">nrow</span>(d),
       <span class="dt">nodeNames =</span> <span class="kw">names</span>(d),
       <span class="dt">label.scale =</span> <span class="ot">FALSE</span>, <span class="dt">label.cex =</span> .<span class="dv">8</span>, 
       <span class="dt">legend =</span> <span class="ot">TRUE</span>, <span class="dt">legend.cex =</span> .<span class="dv">5</span>,
       <span class="dt">layout =</span> <span class="st">&quot;spring&quot;</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:qgraph-example"></span>
<img src="R-package-catalogue_files/figure-html/qgraph-example-1.png" alt="Network of mood items from CSD data set" width="100%" />
<p class="caption">
Figure 12.5: Network of mood items from CSD data set
</p>
</div>
<p>Package <code>qgraph</code> also provides functions to analyze qualities of fitted networks, such as the centrality of nodes in the network. In the network plot above, node <code>md_s</code> appears to be a central node in the network. This is confirmed by calling <code>centralityPlot</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">centralityPlot</span>(g)</code></pre></div>
<p><img src="R-package-catalogue_files/figure-html/qgraph-centrality-example-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="bootnet" class="section level3">
<h3><span class="header-section-number">12.6.2</span> bootnet</h3>

<p>In the interpretation of fitted networks, it is important to take the stability of the network into account. Intuitively, networks that are fit on small sample data sets will be less stable than networks based on large data sets. One solution is to asses this is to fit a large number of networks on subsets of the original data, via bootstrapping. In stable networks, the variability of edge estimations and other characteristics will be small, while in unstable networks, the variance will be large. This idea is implemented in package <em>bootnet</em> <span class="citation">(Epskamp, Borsboom, &amp; Fried, <a href="#ref-Epskamp2018a">2018</a>)</span>.</p>
<p>Below, the stability of the network that was fit in the previous example is examined with <code>bootnet</code>: fifty networks are fit, based on fifty bootstrapped samples. In the results plot, the red line marks the strength of the edges in the full sample, while grey confidence intervals mark the distribution of the edge weights in the bootstraps.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A bootstrapped network. </span>
<span class="kw">library</span>(bootnet)

g &lt;-<span class="st"> </span><span class="kw">estimateNetwork</span>(d, <span class="dt">default =</span> <span class="st">&quot;EBICglasso&quot;</span>,
                     <span class="dt">corArgs =</span> <span class="kw">list</span>(<span class="dt">detectOrdinal =</span> <span class="ot">FALSE</span>))
results &lt;-<span class="st"> </span><span class="kw">bootnet</span>(g, <span class="dt">nBoots =</span> <span class="dv">50</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)
<span class="kw">plot</span>(results, <span class="dt">order =</span> <span class="st">&quot;mean&quot;</span>)</code></pre></div>
<p><img src="R-package-catalogue_files/figure-html/bootnet-example-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="timeseries-analysis" class="section level2">
<h2><span class="header-section-number">12.7</span> Timeseries analysis</h2>
<div id="lomb" class="section level3">
<h3><span class="header-section-number">12.7.1</span> lomb</h3>
<p>  </p>
<p>Disturbances in circadian rhythms have been related to depressive symptoms <span class="citation">(see, e.g., Saeb et al., <a href="#ref-Saeb2015">2015</a>)</span>. With so-called periodograms, these circadian rhythms can be detected in EMA data (see Chapter <a href="features.html#features">7</a>). Standard analysis techniques, however, expect regular time-series, in which data are sampled at equidistant intervals. EMA data, typically, are not equidistant. One solution to this problem is to use the Lomb-Scargle periodogram procedure <span class="citation">(Lomb, <a href="#ref-Lomb1976">1976</a>)</span>, which can be applied to unevenly-sampled time-series as well. Package <em>lomb</em> <span class="citation">(Ruf, <a href="#ref-ruf1999">1999</a>)</span> implements this procedure.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Calculating a Lomb-Scargle periodogram.</span>
<span class="kw">data</span>(ibex, <span class="dt">package =</span> <span class="st">&quot;lomb&quot;</span>) 
lomb<span class="op">::</span><span class="kw">lsp</span>(ibex[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>]) </code></pre></div>
<p><img src="R-package-catalogue_files/figure-html/lmob-example-1.png" width="98%" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>



<h3>References</h3>
<div id="refs" class="references">
<div id="ref-R_GENEAread">
<p>Fang, Z., Langford, J., &amp; Sweetland, C. (2018). <em>GENEAread: Read GENEA binary files</em>. Retrieved from <a href="https://CRAN.R-project.org/package=GENEAread" class="uri">https://CRAN.R-project.org/package=GENEAread</a></p>
</div>
<div id="ref-R-GGIR">
<p>Van Hees, V. T., Fang, Z., Zhao, J. H., Heywood, J., Mirkes, E., Sabia, S., &amp; Migueles, J. H. (2018). <em>GGIR: Raw accelerometer data analysis</em>. <a href="https://doi.org/10.5281/zenodo.1051064" class="uri">https://doi.org/10.5281/zenodo.1051064</a></p>
</div>
<div id="ref-R-PhysicalActivity">
<p>Choi, L., Beck, C., Liu, Z., Matthews, C. E., &amp; Buchowski, M. S. (2018). <em>PhysicalActivity: Process accelerometer data for physical activity measurement</em>. Retrieved from <a href="https://CRAN.R-project.org/package=PhysicalActivity" class="uri">https://CRAN.R-project.org/package=PhysicalActivity</a></p>
</div>
<div id="ref-R-autovarCore">
<p>Emerencia, A. C. (2018). <em>AutovarCore: Automated vector autoregression models and networks</em>. Retrieved from <a href="https://CRAN.R-project.org/package=autovarCore" class="uri">https://CRAN.R-project.org/package=autovarCore</a></p>
</div>
<div id="ref-Emerencia2016">
<p>Emerencia, A. C., Van der Krieke, L., Bos, E. H., De Jonge, P., Petkov, N., &amp; Aiello, M. (2016). Automating vector autoregression on electronic patient diary data. <em>IEEE Journal of Biomedical and Health Informatics</em>. <a href="https://doi.org/10.1109/JBHI.2015.2402280" class="uri">https://doi.org/10.1109/JBHI.2015.2402280</a></p>
</div>
<div id="ref-VanderKrieke2015">
<p>Van der Krieke, L., Emerencia, A. C., Bos, H. E., Rosmalen, G. J., Riese, H., Aiello, M., … de Jonge, P. (2015). Ecological momentary assessments and automated time series analysis to promote tailored health care: A proof-of-principle study. <em>JMIR Research Protocols</em>, <em>4</em>(3), e100. <a href="https://doi.org/10.2196/resprot.4000" class="uri">https://doi.org/10.2196/resprot.4000</a></p>
</div>
<div id="ref-R-dplyr">
<p>Wickham, H., François, R., Henry, L., &amp; Müller, K. (2018). <em>Dplyr: A grammar of data manipulation</em>. Retrieved from <a href="https://CRAN.R-project.org/package=dplyr" class="uri">https://CRAN.R-project.org/package=dplyr</a></p>
</div>
<div id="ref-wickham2016r">
<p>Wickham, H., &amp; Grolemund, G. (2016). <em>R for data science: Import, tidy, transform, visualize, and model data</em>. “ O’Reilly Media, Inc.”</p>
</div>
<div id="ref-wickham2016ggplot2">
<p>Wickham, H. (2016). <em>Ggplot2: Elegant graphics for data analysis</em>. Springer. <a href="https://doi.org/10.1007/978-0-387-98141-3" class="uri">https://doi.org/10.1007/978-0-387-98141-3</a></p>
</div>
<div id="ref-wilkinson2006">
<p>Wilkinson, L. (2006). <em>The grammar of graphics</em>. Springer Science &amp; Business Media.</p>
</div>
<div id="ref-R-haven">
<p>Wickham, H., &amp; Miller, E. (2018). <em>Haven: Import and export ’SPSS’, ’Stata’ and ’SAS’ files</em>. Retrieved from <a href="https://CRAN.R-project.org/package=haven" class="uri">https://CRAN.R-project.org/package=haven</a></p>
</div>
<div id="ref-R-lubridate">
<p>Grolemund, G., &amp; Wickham, H. (2011). Dates and times made easy with lubridate. <em>Journal of Statistical Software</em>, <em>40</em>(3), 1–25. Retrieved from <a href="http://www.jstatsoft.org/v40/i03/" class="uri">http://www.jstatsoft.org/v40/i03/</a></p>
</div>
<div id="ref-R-nlme">
<p>Pinheiro, J., Bates, D., DebRoy, S., Sarkar, D., &amp; R Core Team. (2018). <em>nlme: Linear and nonlinear mixed effects models</em>. Retrieved from <a href="https://CRAN.R-project.org/package=nlme" class="uri">https://CRAN.R-project.org/package=nlme</a></p>
</div>
<div id="ref-Bates2015">
<p>Bates, D., Mächler, M., Bolker, B., &amp; Walker, S. (2015). Fitting inear mixed-effects models using lme4. <em>Journal of Statistical Software</em>, <em>67</em>(1), 1–48. <a href="https://doi.org/10.18637/jss.v067.i01" class="uri">https://doi.org/10.18637/jss.v067.i01</a></p>
</div>
<div id="ref-Green2016">
<p>Green, P., &amp; MacLeod, C. J. (2016). Simr: An R package for power analysis of generalised linear mixed models by simulation. <em>Methods in Ecology and Evolution</em>, <em>7</em>(4), 493–498. <a href="https://doi.org/10.1111/2041-210X.12504" class="uri">https://doi.org/10.1111/2041-210X.12504</a></p>
</div>
<div id="ref-Borsboom2017">
<p>Borsboom, D. (2017). A network theory of mental disorders. <em>World Psychiatry</em>. <a href="https://doi.org/10.1002/wps.20375" class="uri">https://doi.org/10.1002/wps.20375</a></p>
</div>
<div id="ref-Borsboom2013">
<p>Borsboom, D., &amp; Cramer, A. O. J. (2013). Network analysis: An integrative approach to the structure of psychopathology. <em>Annual Review of Clinical Psychology</em>, <em>9</em>(1), 91–121. <a href="https://doi.org/doi:10.1146/annurev-clinpsy-050212-185608" class="uri">https://doi.org/doi:10.1146/annurev-clinpsy-050212-185608</a></p>
</div>
<div id="ref-Bringmann2015">
<p>Bringmann, L. F., Lemmens, L. H., Huibers, M. J., Borsboom, D., &amp; Tuerlinckx, F. (2015). Revealing the dynamic network structure of the Beck Depression Inventory-II. <em>Psychological Medicine</em>. <a href="https://doi.org/10.1017/S0033291714001809" class="uri">https://doi.org/10.1017/S0033291714001809</a></p>
</div>
<div id="ref-Epskamp2012">
<p>Epskamp, S., Cramer, A. O. J., Waldorp, L. J., Schmittmann, V. D., &amp; Borsboom, D. (2012). Qgraph: Network visualizations of relationships in psychometric data. <em>Journal of Statistical Software</em>, <em>48</em>(4), 1–18. <a href="https://doi.org/10.18637/jss.v048.i04" class="uri">https://doi.org/10.18637/jss.v048.i04</a></p>
</div>
<div id="ref-Epskamp2018a">
<p>Epskamp, S., Borsboom, D., &amp; Fried, E. I. (2018). Estimating psychological networks and their accuracy: A tutorial paper. <em>Behavior Research Methods</em>, <em>50</em>(1), 195–212. <a href="https://doi.org/10.3758/s13428-017-0862-1" class="uri">https://doi.org/10.3758/s13428-017-0862-1</a></p>
</div>
<div id="ref-Saeb2015">
<p>Saeb, S., Zhang, M., Karr, C. J., Schueller, S. M., Corden, M. E., Kording, K. P., &amp; Mohr, D. C. (2015). Mobile phone sensor correlates of depressive symptom severity in daily-life behavior: An exploratory study. <em>Journal of Medical Internet Research</em>, <em>17</em>(7). <a href="https://doi.org/10.2196/jmir.4273" class="uri">https://doi.org/10.2196/jmir.4273</a></p>
</div>
<div id="ref-Lomb1976">
<p>Lomb, N. R. (1976). Least-squares frequency analysis of unequally spaced data. <em>Astrophysics and Space Science</em>. <a href="https://doi.org/10.1007/BF00648343" class="uri">https://doi.org/10.1007/BF00648343</a></p>
</div>
<div id="ref-ruf1999">
<p>Ruf, T. (1999). The lomb-scargle periodogram in biological rhythm research: Analysis of incomplete and unequally spaced time-series. <em>Biological Rhythm Research</em>, <em>30</em>, 178–201. <a href="https://doi.org/10.1076/brhm.30.2.178.1422" class="uri">https://doi.org/10.1076/brhm.30.2.178.1422</a></p>
</div>
</div>
<script>
  /*
  Sorts the references alphabetically.
  Modified from code by Yvonne Aburrow.
  */
  $(function(){
    var elems = $('#refs').children('div').remove();
    elems.sort(function (a, b) {
      return $(b).children('p').html().toUpperCase() > $(a).children('p').html().toUpperCase() ? -1 : 1;
    });
    $('#refs').append(elems);
  })
</script>
            </section>

          </div>
        </div>
      </div>
<a href="ema-instruments-catalogue.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="acknowledgements.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["EMA_in_Mental_Health_Research.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
